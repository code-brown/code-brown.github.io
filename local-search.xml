<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Apacheè¿ç»´ç»¼åˆé…ç½®æ•™ç¨‹</title>
    <link href="/2025/05/14/Apache%E8%BF%90%E7%BB%B4%E7%BB%BC%E5%90%88%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B/"/>
    <url>/2025/05/14/Apache%E8%BF%90%E7%BB%B4%E7%BB%BC%E5%90%88%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<blockquote><p>#æœ¬æ–‡ç”±AIè¾…åŠ©å®Œæˆ</p></blockquote><hr><h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ol><li><a href="#%E4%B8%80%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E7%A1%80%E9%AA%8C%E8%AF%81">å®‰è£…ä¸åŸºç¡€éªŒè¯</a></li><li><a href="#%E4%BA%8C%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E9%85%8D%E7%BD%AE">è™šæ‹Ÿä¸»æœºé…ç½®</a></li><li><a href="#%E4%B8%89ssltls-%E5%8A%A0%E5%AF%86">SSL&#x2F;TLS åŠ å¯†</a></li><li><a href="#%E5%9B%9B%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97%E7%AE%A1%E7%90%86">å¸¸ç”¨æ¨¡å—ç®¡ç†</a></li><li><a href="#%E4%BA%94%E6%97%A5%E5%BF%97%E4%B8%8E%E6%97%A5%E5%BF%97%E8%BD%AE%E8%BD%AC">æ—¥å¿—ä¸æ—¥å¿—è½®è½¬</a></li><li><a href="#%E5%85%AD%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA">å®‰å…¨åŠ å›º</a></li><li><a href="#%E4%B8%83%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98">æ€§èƒ½è°ƒä¼˜</a></li><li><a href="#%E5%85%AB%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E4%B8%8E%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1">åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡</a></li><li><a href="#%E4%B9%9D%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E4%B8%8E%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5">å¸¸è§é—®é¢˜ä¸æ•…éšœæ’æŸ¥</a></li><li><a href="#%E5%8D%81%E6%89%A9%E5%B1%95%E5%B7%A5%E5%85%B7%E4%B8%8E%E9%9B%86%E6%88%90%E5%BB%BA%E8%AE%AE">æ‰©å±•å·¥å…·ä¸é›†æˆå»ºè®®</a></li></ol><hr><h2 id="ä¸€ã€å®‰è£…ä¸åŸºç¡€éªŒè¯"><a href="#ä¸€ã€å®‰è£…ä¸åŸºç¡€éªŒè¯" class="headerlink" title="ä¸€ã€å®‰è£…ä¸åŸºç¡€éªŒè¯"></a>ä¸€ã€å®‰è£…ä¸åŸºç¡€éªŒè¯</h2><h3 id="1-ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…"><a href="#1-ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…" class="headerlink" title="1. ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…"></a>1. ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…</h3><h4 id="CentOS-RHEL-ç³»åˆ—"><a href="#CentOS-RHEL-ç³»åˆ—" class="headerlink" title="CentOS&#x2F;RHEL ç³»åˆ—"></a>CentOS&#x2F;RHEL ç³»åˆ—</h4><ol><li><p><strong>æ›´æ–°ä»“åº“ç¼“å­˜</strong>  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> yum makecache fast<br></code></pre></td></tr></table></figure><ul><li>åˆ·æ–°æœ¬åœ°å…ƒæ•°æ®ç¼“å­˜ï¼Œç¡®ä¿è·å–æœ€æ–°è½¯ä»¶åŒ…ä¿¡æ¯ã€‚</li></ul></li><li><p><strong>å®‰è£… Apache åŒ…</strong>  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> yum install -y httpd<br></code></pre></td></tr></table></figure><ul><li><code>-y</code> è‡ªåŠ¨ç¡®è®¤ï¼Œé€‚åˆè„šæœ¬åŒ–éƒ¨ç½²ã€‚</li></ul></li><li><p><strong>è®¾ç½®å¼€æœºè‡ªå¯</strong>  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl <span class="hljs-built_in">enable</span> httpd<br></code></pre></td></tr></table></figure><ul><li>å°† httpd æœåŠ¡åŠ å…¥ systemd å¯åŠ¨åˆ—è¡¨ã€‚</li></ul></li><li><p><strong>å¯åŠ¨æœåŠ¡å¹¶æ£€æŸ¥çŠ¶æ€</strong>  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl start httpd<br><span class="hljs-built_in">sudo</span> systemctl status httpd<br></code></pre></td></tr></table></figure><ul><li><code>status</code> å‘½ä»¤å¯è¿”å›æœåŠ¡å½“å‰çŠ¶æ€å’Œæœ€è¿‘æ—¥å¿—æ¡ç›®ã€‚</li></ul></li><li><p><strong>æ”¾è¡Œé˜²ç«å¢™ç«¯å£ï¼ˆå¯é€‰ï¼‰</strong>  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> firewall-cmd --permanent --add-service=http<br><span class="hljs-built_in">sudo</span> firewall-cmd --permanent --add-service=https<br><span class="hljs-built_in">sudo</span> firewall-cmd --reload<br></code></pre></td></tr></table></figure><ul><li><code>firewall-cmd</code> æ˜¯ firewalld çš„å‘½ä»¤è¡Œå·¥å…·ã€‚</li></ul></li></ol><h4 id="Debian-Ubuntu-ç³»åˆ—"><a href="#Debian-Ubuntu-ç³»åˆ—" class="headerlink" title="Debian&#x2F;Ubuntu ç³»åˆ—"></a>Debian&#x2F;Ubuntu ç³»åˆ—</h4><ol><li><strong>æ›´æ–°è½¯ä»¶æºç´¢å¼•</strong>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt update<br></code></pre></td></tr></table></figure></li><li><strong>å®‰è£… Apache2</strong>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt install -y apache2<br></code></pre></td></tr></table></figure></li><li><strong>å¯åŠ¨æœåŠ¡å¹¶è®¾ç½®è‡ªå¯</strong>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl start apache2<br><span class="hljs-built_in">sudo</span> systemctl <span class="hljs-built_in">enable</span> apache2<br></code></pre></td></tr></table></figure></li><li><strong>æŸ¥çœ‹æœåŠ¡çŠ¶æ€</strong>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl status apache2<br></code></pre></td></tr></table></figure></li></ol><h3 id="2-éªŒè¯å®‰è£…"><a href="#2-éªŒè¯å®‰è£…" class="headerlink" title="2. éªŒè¯å®‰è£…"></a>2. éªŒè¯å®‰è£…</h3><ul><li><p>åœ¨æµè§ˆå™¨ä¸­è®¿é—® <code>http://&lt;æœåŠ¡å™¨IPæˆ–åŸŸå&gt;/</code>ã€‚<br>-è¾“å‡ºç¤ºä¾‹ï¼š</p><ul><li>CentOS&#x2F;RHEL: â€œApache HTTP Server Test Pageâ€</li><li>Debian&#x2F;Ubuntu: â€œApache2 Debian Default Pageâ€</li></ul></li><li><p>å¦‚æœæœªæ˜¾ç¤ºï¼Œæ£€æŸ¥ç«¯å£ç›‘å¬çŠ¶æ€ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> ss -tuln | grep <span class="hljs-string">&#x27;:80&#x27;</span><br></code></pre></td></tr></table></figure></li></ul><hr><h2 id="äºŒã€è™šæ‹Ÿä¸»æœºé…ç½®"><a href="#äºŒã€è™šæ‹Ÿä¸»æœºé…ç½®" class="headerlink" title="äºŒã€è™šæ‹Ÿä¸»æœºé…ç½®"></a>äºŒã€è™šæ‹Ÿä¸»æœºé…ç½®</h2><blockquote><p>ä½¿ç”¨ VirtualHost å¯åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šæ‰˜ç®¡å¤šä¸ªç«™ç‚¹ï¼ŒæŒ‰åŸŸåæˆ– IP åŒºåˆ†ä¸åŒå†…å®¹ã€‚</p></blockquote><h3 id="1-å‡†å¤‡æ–‡æ¡£æ ¹ç›®å½•"><a href="#1-å‡†å¤‡æ–‡æ¡£æ ¹ç›®å½•" class="headerlink" title="1. å‡†å¤‡æ–‡æ¡£æ ¹ç›®å½•"></a>1. å‡†å¤‡æ–‡æ¡£æ ¹ç›®å½•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">mkdir</span> -p /var/www/html/example<br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">mkdir</span> -p /var/www/html/shop<br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">chown</span> -R <span class="hljs-variable">$USER</span>:<span class="hljs-variable">$USER</span> /var/www/html/example /var/www/html/shop<br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">chmod</span> -R 755 /var/www/html<br></code></pre></td></tr></table></figure><ul><li><code>chown</code>ï¼šæ›´æ”¹ç›®å½•æ‰€æœ‰è€…  </li><li><code>chmod 755</code>ï¼šç”¨æˆ·è¯»å†™æ‰§è¡Œï¼Œç»„å’Œå…¶ä»–ç”¨æˆ·åªè¯»æ‰§è¡Œ</li></ul><h3 id="2-åˆ›å»ºæµ‹è¯•é¡µé¢"><a href="#2-åˆ›å»ºæµ‹è¯•é¡µé¢" class="headerlink" title="2. åˆ›å»ºæµ‹è¯•é¡µé¢"></a>2. åˆ›å»ºæµ‹è¯•é¡µé¢</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&lt;h1&gt;Welcome to Example Site&lt;/h1&gt;&quot;</span> &gt; /var/www/html/example/index.html<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&lt;h1&gt;Welcome to Shop Site&lt;/h1&gt;&quot;</span> &gt; /var/www/html/shop/index.html<br></code></pre></td></tr></table></figure><h3 id="3-é…ç½®è™šæ‹Ÿä¸»æœº"><a href="#3-é…ç½®è™šæ‹Ÿä¸»æœº" class="headerlink" title="3. é…ç½®è™šæ‹Ÿä¸»æœº"></a>3. é…ç½®è™šæ‹Ÿä¸»æœº</h3><p>ç¼–è¾‘ <code>vhosts.conf</code>ï¼š</p><ul><li>RHEL&#x2F;CentOS: <code>/etc/httpd/conf.d/vhosts.conf</code>  </li><li>Debian&#x2F;Ubuntu: <code>/etc/apache2/sites-available/vhosts.conf</code></li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;VirtualHost *<span class="hljs-number">:80</span>&gt;</span><br>    <span class="hljs-attribute">ServerName</span> www.example.com<br>    <span class="hljs-attribute">ServerAlias</span> example.com<br>    <span class="hljs-attribute">DocumentRoot</span> /var/www/html/example<br>    <span class="hljs-section">&lt;Directory /var/www/html/example&gt;</span><br>        <span class="hljs-attribute">Options</span> Indexes FollowSymLinks<br>        <span class="hljs-attribute">AllowOverride</span> <span class="hljs-literal">All</span><br>        <span class="hljs-attribute">Require</span> <span class="hljs-literal">all</span> granted<br>    <span class="hljs-section">&lt;/Directory&gt;</span><br>    <span class="hljs-attribute">ErrorLog</span> <span class="hljs-variable">$&#123;APACHE_LOG_DIR&#125;</span>/example_error.log<br>    <span class="hljs-attribute">CustomLog</span> <span class="hljs-variable">$&#123;APACHE_LOG_DIR&#125;</span>/example_access.log combined<br><span class="hljs-section">&lt;/VirtualHost&gt;</span><br><br><span class="hljs-section">&lt;VirtualHost *<span class="hljs-number">:80</span>&gt;</span><br>    <span class="hljs-attribute">ServerName</span> shop.example.com<br>    <span class="hljs-attribute">ServerAlias</span> shop.example.com<br>    <span class="hljs-attribute">DocumentRoot</span> /var/www/html/shop<br>    <span class="hljs-section">&lt;Directory /var/www/html/shop&gt;</span><br>        <span class="hljs-attribute">Options</span> Indexes FollowSymLinks<br>        <span class="hljs-attribute">AllowOverride</span> <span class="hljs-literal">All</span><br>        <span class="hljs-attribute">Require</span> <span class="hljs-literal">all</span> granted<br>    <span class="hljs-section">&lt;/Directory&gt;</span><br>    <span class="hljs-attribute">ErrorLog</span> <span class="hljs-variable">$&#123;APACHE_LOG_DIR&#125;</span>/shop_error.log<br>    <span class="hljs-attribute">CustomLog</span> <span class="hljs-variable">$&#123;APACHE_LOG_DIR&#125;</span>/shop_access.log combined<br><span class="hljs-section">&lt;/VirtualHost&gt;</span><br></code></pre></td></tr></table></figure><ul><li><code>ServerAlias</code>ï¼šé¢å¤–åŸŸå  </li><li><code>AllowOverride All</code>ï¼šå…è®¸ç›®å½•è¦†ç›– .htaccess</li></ul><h3 id="4-å¯ç”¨å¹¶é‡è½½"><a href="#4-å¯ç”¨å¹¶é‡è½½" class="headerlink" title="4. å¯ç”¨å¹¶é‡è½½"></a>4. å¯ç”¨å¹¶é‡è½½</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> a2ensite vhosts.conf        <span class="hljs-comment"># Debian/Ubuntu</span><br><span class="hljs-built_in">sudo</span> systemctl reload httpd<br></code></pre></td></tr></table></figure><h3 id="5-éªŒè¯"><a href="#5-éªŒè¯" class="headerlink" title="5. éªŒè¯"></a>5. éªŒè¯</h3><ul><li>ä¿®æ”¹æœ¬åœ° hosts æ–‡ä»¶ <code>/etc/hosts</code>ï¼š<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">127.0.0.1</span> www.example.com example.com shop.example.com<br></code></pre></td></tr></table></figure></li><li>è®¿é—® <code>http://www.example.com</code> ä¸ <code>http://shop.example.com</code></li></ul><hr><h2 id="ä¸‰ã€SSL-TLS-åŠ å¯†"><a href="#ä¸‰ã€SSL-TLS-åŠ å¯†" class="headerlink" title="ä¸‰ã€SSL&#x2F;TLS åŠ å¯†"></a>ä¸‰ã€SSL&#x2F;TLS åŠ å¯†</h2><blockquote><p>SSL&#x2F;TLS æä¾› HTTPS åŠ å¯†è®¿é—®ï¼Œé¿å…æ˜æ–‡ä¼ è¾“æ•æ„Ÿä¿¡æ¯ã€‚</p></blockquote><h3 id="1-ç”Ÿæˆç§é’¥å’Œ-CSR"><a href="#1-ç”Ÿæˆç§é’¥å’Œ-CSR" class="headerlink" title="1. ç”Ÿæˆç§é’¥å’Œ CSR"></a>1. ç”Ÿæˆç§é’¥å’Œ CSR</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">mkdir</span> -p /etc/httpd/ssl<br><span class="hljs-built_in">cd</span> /etc/httpd/ssl<br><span class="hljs-built_in">sudo</span> openssl genpkey -algorithm RSA -out www.example.com.key -pkeyopt rsa_keygen_bits:2048<br><span class="hljs-built_in">sudo</span> openssl req -new -key www.example.com.key -out www.example.com.csr \<br>  -subj <span class="hljs-string">&quot;/C=CN/ST=Beijing/L=Beijing/O=Example Corp/OU=IT/CN=www.example.com&quot;</span><br></code></pre></td></tr></table></figure><ul><li><code>genpkey</code>ï¼šæ¨èçš„ç”Ÿæˆå¯†é’¥æ–¹æ³•  </li><li>CSR åŒ…å«å…¬é’¥åŠç»„ç»‡ä¿¡æ¯</li></ul><h3 id="2-è‡ªç­¾åè¯ä¹¦ç”Ÿæˆ"><a href="#2-è‡ªç­¾åè¯ä¹¦ç”Ÿæˆ" class="headerlink" title="2. è‡ªç­¾åè¯ä¹¦ç”Ÿæˆ"></a>2. è‡ªç­¾åè¯ä¹¦ç”Ÿæˆ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> openssl x509 -req -days 365 -<span class="hljs-keyword">in</span> www.example.com.csr \<br>  -signkey www.example.com.key -out www.example.com.crt<br></code></pre></td></tr></table></figure><ul><li><code>-days 365</code>ï¼šè¯ä¹¦æœ‰æ•ˆæœŸ 1 å¹´</li></ul><h3 id="3-å®‰è£…å¹¶å¯ç”¨-SSL-æ¨¡å—"><a href="#3-å®‰è£…å¹¶å¯ç”¨-SSL-æ¨¡å—" class="headerlink" title="3. å®‰è£…å¹¶å¯ç”¨ SSL æ¨¡å—"></a>3. å®‰è£…å¹¶å¯ç”¨ SSL æ¨¡å—</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> yum install -y mod_ssl       <span class="hljs-comment"># RHEL/CentOS</span><br><span class="hljs-built_in">sudo</span> a2enmod ssl                 <span class="hljs-comment"># Debian/Ubuntu</span><br></code></pre></td></tr></table></figure><h3 id="4-é…ç½®-HTTPS-è™šæ‹Ÿä¸»æœº"><a href="#4-é…ç½®-HTTPS-è™šæ‹Ÿä¸»æœº" class="headerlink" title="4. é…ç½® HTTPS è™šæ‹Ÿä¸»æœº"></a>4. é…ç½® HTTPS è™šæ‹Ÿä¸»æœº</h3><p>åœ¨ <code>vhosts.conf</code> æœ«å°¾æ·»åŠ ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;VirtualHost *<span class="hljs-number">:443</span>&gt;</span><br>    <span class="hljs-attribute">ServerName</span> www.example.com<br>    <span class="hljs-attribute">DocumentRoot</span> /var/www/html/example<br>    <span class="hljs-attribute">SSLEngine</span> <span class="hljs-literal">on</span><br>    <span class="hljs-attribute">SSLCertificateFile</span> /etc/httpd/ssl/www.example.com.crt<br>    <span class="hljs-attribute">SSLCertificateKeyFile</span> /etc/httpd/ssl/www.example.com.key<br>    <span class="hljs-section">&lt;Directory /var/www/html/example&gt;</span><br>        <span class="hljs-attribute">Require</span> <span class="hljs-literal">all</span> granted<br>    <span class="hljs-section">&lt;/Directory&gt;</span><br><span class="hljs-section">&lt;/VirtualHost&gt;</span><br></code></pre></td></tr></table></figure><h3 id="5-é˜²ç«å¢™åŠé‡å¯"><a href="#5-é˜²ç«å¢™åŠé‡å¯" class="headerlink" title="5. é˜²ç«å¢™åŠé‡å¯"></a>5. é˜²ç«å¢™åŠé‡å¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> firewall-cmd --permanent --add-port=443/tcp<br><span class="hljs-built_in">sudo</span> firewall-cmd --reload<br><span class="hljs-built_in">sudo</span> systemctl restart httpd<br></code></pre></td></tr></table></figure><hr><h2 id="å››ã€å¸¸ç”¨æ¨¡å—ç®¡ç†"><a href="#å››ã€å¸¸ç”¨æ¨¡å—ç®¡ç†" class="headerlink" title="å››ã€å¸¸ç”¨æ¨¡å—ç®¡ç†"></a>å››ã€å¸¸ç”¨æ¨¡å—ç®¡ç†</h2><h3 id="URL-é‡å†™-mod-rewrite"><a href="#URL-é‡å†™-mod-rewrite" class="headerlink" title="URL é‡å†™ (mod_rewrite)"></a>URL é‡å†™ (mod_rewrite)</h3><ul><li>å¯ç”¨æ¨¡å—ï¼š<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> a2enmod rewrite<br></code></pre></td></tr></table></figure></li><li>æ ¸å¿ƒæŒ‡ä»¤è§£é‡Šï¼š<ul><li><code>RewriteEngine On</code>ï¼šæ‰“å¼€é‡å†™å¼•æ“</li><li><code>RewriteRule Pattern Substitution [Flags]</code></li></ul></li></ul><p>.htaccess ç¤ºä¾‹ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">RewriteEngine</span> <span class="hljs-literal">On</span><br><span class="hljs-attribute">RewriteRule</span> ^old-page\.html$ /new-page.html<span class="hljs-meta"> [R=301,L]</span><br></code></pre></td></tr></table></figure><h3 id="è·¯å¾„åˆ«å-mod-alias"><a href="#è·¯å¾„åˆ«å-mod-alias" class="headerlink" title="è·¯å¾„åˆ«å (mod_alias)"></a>è·¯å¾„åˆ«å (mod_alias)</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Alias</span> /docs /var/www/shared/docs<br><span class="hljs-section">&lt;Directory /var/www/shared/docs&gt;</span><br>    <span class="hljs-attribute">Options</span> Indexes<br>    <span class="hljs-attribute">Require</span> <span class="hljs-literal">all</span> granted<br><span class="hljs-section">&lt;/Directory&gt;</span><br></code></pre></td></tr></table></figure><ul><li><code>Alias</code>ï¼šURL åˆ°æ–‡ä»¶è·¯å¾„æ˜ å°„</li></ul><h3 id="æœåŠ¡å™¨çŠ¶æ€ç›‘æ§-mod-status"><a href="#æœåŠ¡å™¨çŠ¶æ€ç›‘æ§-mod-status" class="headerlink" title="æœåŠ¡å™¨çŠ¶æ€ç›‘æ§ (mod_status)"></a>æœåŠ¡å™¨çŠ¶æ€ç›‘æ§ (mod_status)</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;Location /server-status&gt;</span><br>    <span class="hljs-attribute">SetHandler</span> server-status<br>    <span class="hljs-attribute">Require</span> local<br><span class="hljs-section">&lt;/Location&gt;</span><br><span class="hljs-attribute">ExtendedStatus</span> <span class="hljs-literal">On</span><br></code></pre></td></tr></table></figure><ul><li><code>ExtendedStatus</code>ï¼šæ”¶é›†æ›´è¯¦ç»†æŒ‡æ ‡</li></ul><hr><h2 id="äº”ã€æ—¥å¿—ä¸æ—¥å¿—è½®è½¬"><a href="#äº”ã€æ—¥å¿—ä¸æ—¥å¿—è½®è½¬" class="headerlink" title="äº”ã€æ—¥å¿—ä¸æ—¥å¿—è½®è½¬"></a>äº”ã€æ—¥å¿—ä¸æ—¥å¿—è½®è½¬</h2><h3 id="è‡ªå®šä¹‰æ—¥å¿—æ ¼å¼"><a href="#è‡ªå®šä¹‰æ—¥å¿—æ ¼å¼" class="headerlink" title="è‡ªå®šä¹‰æ—¥å¿—æ ¼å¼"></a>è‡ªå®šä¹‰æ—¥å¿—æ ¼å¼</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">LogFormat</span> <span class="hljs-string">&quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b %D&quot;</span> detailed<br><span class="hljs-attribute">CustomLog</span> /var/log/httpd/access_detailed.log detailed<br></code></pre></td></tr></table></figure><ul><li><code>%&gt;s</code>ï¼šå®é™…è¿”å›ç»™å®¢æˆ·ç«¯çš„çŠ¶æ€ç </li><li><code>%b</code>ï¼šå“åº”å¤§å°ï¼ˆä¸åŒ…å«å¤´ï¼‰</li></ul><h3 id="logrotate-é…ç½®"><a href="#logrotate-é…ç½®" class="headerlink" title="logrotate é…ç½®"></a>logrotate é…ç½®</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs text">/var/log/httpd/access_detailed.log &#123;<br>    daily<br>    rotate 14<br>    compress<br>    delaycompress<br>    missingok<br>    notifempty<br>    create 640 root adm<br>    postrotate<br>        systemctl reload httpd<br>    endscript<br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="å…­ã€å®‰å…¨åŠ å›º"><a href="#å…­ã€å®‰å…¨åŠ å›º" class="headerlink" title="å…­ã€å®‰å…¨åŠ å›º"></a>å…­ã€å®‰å…¨åŠ å›º</h2><h3 id="ç¦æ­¢ç›®å½•åˆ—è¡¨"><a href="#ç¦æ­¢ç›®å½•åˆ—è¡¨" class="headerlink" title="ç¦æ­¢ç›®å½•åˆ—è¡¨"></a>ç¦æ­¢ç›®å½•åˆ—è¡¨</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;Directory /var/www/html&gt;</span><br>    <span class="hljs-attribute">Options</span> -Indexes<br><span class="hljs-section">&lt;/Directory&gt;</span><br></code></pre></td></tr></table></figure><h3 id="é™åˆ¶-IP-è®¿é—®"><a href="#é™åˆ¶-IP-è®¿é—®" class="headerlink" title="é™åˆ¶ IP è®¿é—®"></a>é™åˆ¶ IP è®¿é—®</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;Directory /var/www/html/private&gt;</span><br>    <span class="hljs-attribute">Require</span> ip <span class="hljs-number">192.168.0.0</span>/<span class="hljs-number">24</span><br>    <span class="hljs-attribute">Require</span> <span class="hljs-literal">all</span> denied<br><span class="hljs-section">&lt;/Directory&gt;</span><br></code></pre></td></tr></table></figure><h3 id="é˜²-DDoS-æ”»å‡»-mod-evasive"><a href="#é˜²-DDoS-æ”»å‡»-mod-evasive" class="headerlink" title="é˜² DDoS æ”»å‡» (mod_evasive)"></a>é˜² DDoS æ”»å‡» (mod_evasive)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> yum install -y mod_evasive   <span class="hljs-comment"># RHEL/CentOS</span><br><span class="hljs-built_in">sudo</span> apt install -y libapache2-mod-evasive  <span class="hljs-comment"># Debian/Ubuntu</span><br>&lt;IfModule mod_evasive20.c&gt;<br>    DOSHashTableSize    3097<br>    DOSPageCount        2<br>    DOSSiteCount        50<br>    DOSBlockingPeriod   10<br>    DOSLogDir           <span class="hljs-string">&quot;/var/log/mod_evasive&quot;</span><br>&lt;/IfModule&gt;<br></code></pre></td></tr></table></figure><hr><h2 id="ä¸ƒã€æ€§èƒ½è°ƒä¼˜"><a href="#ä¸ƒã€æ€§èƒ½è°ƒä¼˜" class="headerlink" title="ä¸ƒã€æ€§èƒ½è°ƒä¼˜"></a>ä¸ƒã€æ€§èƒ½è°ƒä¼˜</h2><h3 id="Worker-MPM-å¯ç”¨"><a href="#Worker-MPM-å¯ç”¨" class="headerlink" title="Worker MPM å¯ç”¨"></a>Worker MPM å¯ç”¨</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># æ³¨é‡Š prefork</span><br><span class="hljs-comment">#LoadModule mpm_prefork_module modules/mod_mpm_prefork.so</span><br><span class="hljs-attribute">LoadModule</span> mpm_worker_module modules/mod_mpm_worker.so<br></code></pre></td></tr></table></figure><h3 id="è¿›ç¨‹å’Œçº¿ç¨‹é…ç½®"><a href="#è¿›ç¨‹å’Œçº¿ç¨‹é…ç½®" class="headerlink" title="è¿›ç¨‹å’Œçº¿ç¨‹é…ç½®"></a>è¿›ç¨‹å’Œçº¿ç¨‹é…ç½®</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;IfModule mpm_worker_module&gt;</span><br>    <span class="hljs-attribute">StartServers</span>          <span class="hljs-number">3</span><br>    <span class="hljs-attribute">ThreadsPerChild</span>      <span class="hljs-number">25</span><br>    <span class="hljs-attribute">MinSpareThreads</span>      <span class="hljs-number">75</span><br>    <span class="hljs-attribute">MaxSpareThreads</span>     <span class="hljs-number">250</span><br>    <span class="hljs-attribute">MaxRequestWorkers</span>    <span class="hljs-number">1000</span><br>    <span class="hljs-attribute">MaxConnectionsPerChild</span>  <span class="hljs-number">10000</span><br><span class="hljs-section">&lt;/IfModule&gt;</span><br></code></pre></td></tr></table></figure><h3 id="å‹ç¼©ä¸ç¼“å­˜"><a href="#å‹ç¼©ä¸ç¼“å­˜" class="headerlink" title="å‹ç¼©ä¸ç¼“å­˜"></a>å‹ç¼©ä¸ç¼“å­˜</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;IfModule mod_deflate.c&gt;</span><br>    <span class="hljs-attribute">AddOutputFilterByType</span> DEFLATE text/html text/css application/javascript image/svg+xml<br><span class="hljs-section">&lt;/IfModule&gt;</span><br><span class="hljs-section">&lt;IfModule mod_expires.c&gt;</span><br>    <span class="hljs-attribute">ExpiresActive</span> <span class="hljs-literal">On</span><br>    <span class="hljs-attribute">ExpiresByType</span> text/css <span class="hljs-string">&quot;access plus 7 days&quot;</span><br>    <span class="hljs-attribute">ExpiresByType</span> application/javascript <span class="hljs-string">&quot;access plus 7 days&quot;</span><br>    <span class="hljs-attribute">ExpiresByType</span> image/* <span class="hljs-string">&quot;access plus 30 days&quot;</span><br><span class="hljs-section">&lt;/IfModule&gt;</span><br></code></pre></td></tr></table></figure><hr><h2 id="å…«ã€åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡"><a href="#å…«ã€åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡" class="headerlink" title="å…«ã€åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡"></a>å…«ã€åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡</h2><h3 id="å¯ç”¨æ¨¡å—"><a href="#å¯ç”¨æ¨¡å—" class="headerlink" title="å¯ç”¨æ¨¡å—"></a>å¯ç”¨æ¨¡å—</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> a2enmod proxy proxy_http proxy_balancer lbmethod_byrequests<br></code></pre></td></tr></table></figure><h3 id="è´Ÿè½½å‡è¡¡ç¤ºä¾‹"><a href="#è´Ÿè½½å‡è¡¡ç¤ºä¾‹" class="headerlink" title="è´Ÿè½½å‡è¡¡ç¤ºä¾‹"></a>è´Ÿè½½å‡è¡¡ç¤ºä¾‹</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;Proxy <span class="hljs-string">&quot;balancer://backend_cluster&quot;</span>&gt;</span><br>    <span class="hljs-attribute">BalancerMember</span> http://<span class="hljs-number">10.0.0.1:8080</span> loadfactor=<span class="hljs-number">5</span><br>    <span class="hljs-attribute">BalancerMember</span> http://<span class="hljs-number">10.0.0.2:8080</span><br>    <span class="hljs-attribute">ProxySet</span> lbmethod=byrequests stickysession=JSESSIONID<br><span class="hljs-section">&lt;/Proxy&gt;</span><br><br><span class="hljs-section">&lt;VirtualHost *<span class="hljs-number">:80</span>&gt;</span><br>    <span class="hljs-attribute">ServerName</span> api.example.com<br>    <span class="hljs-attribute">ProxyPass</span> <span class="hljs-string">&quot;/api/&quot;</span> <span class="hljs-string">&quot;balancer://backend_cluster/&quot;</span><br>    <span class="hljs-attribute">ProxyPassReverse</span> <span class="hljs-string">&quot;/api/&quot;</span> <span class="hljs-string">&quot;balancer://backend_cluster/&quot;</span><br><span class="hljs-section">&lt;/VirtualHost&gt;</span><br></code></pre></td></tr></table></figure><hr><h2 id="ä¹ã€å¸¸è§é—®é¢˜ä¸æ•…éšœæ’æŸ¥"><a href="#ä¹ã€å¸¸è§é—®é¢˜ä¸æ•…éšœæ’æŸ¥" class="headerlink" title="ä¹ã€å¸¸è§é—®é¢˜ä¸æ•…éšœæ’æŸ¥"></a>ä¹ã€å¸¸è§é—®é¢˜ä¸æ•…éšœæ’æŸ¥</h2><h3 id="æœåŠ¡å¯åŠ¨å¤±è´¥"><a href="#æœåŠ¡å¯åŠ¨å¤±è´¥" class="headerlink" title="æœåŠ¡å¯åŠ¨å¤±è´¥"></a>æœåŠ¡å¯åŠ¨å¤±è´¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl status httpd<br><span class="hljs-built_in">sudo</span> journalctl -xe<br>apachectl configtest<br></code></pre></td></tr></table></figure><ul><li>æ£€æŸ¥é…ç½®è¯­æ³•ã€ç«¯å£å ç”¨ã€æƒé™é—®é¢˜ã€‚</li></ul><h3 id="è™šæ‹Ÿä¸»æœºæ— æ•ˆ"><a href="#è™šæ‹Ÿä¸»æœºæ— æ•ˆ" class="headerlink" title="è™šæ‹Ÿä¸»æœºæ— æ•ˆ"></a>è™šæ‹Ÿä¸»æœºæ— æ•ˆ</h3><ul><li>ç¡®è®¤ <code>ServerName</code> ä¸ <code>ServerAlias</code></li><li>æ‰§è¡Œ <code>apachectl -S</code> æŸ¥çœ‹è™šæ‹Ÿä¸»æœºåŠ è½½æƒ…å†µ</li></ul><h3 id="403-Forbidden"><a href="#403-Forbidden" class="headerlink" title="403 Forbidden"></a>403 Forbidden</h3><ul><li>ç¡®ä¿ <code>Require all granted</code></li><li>SELinux ä¸Šä¸‹æ–‡ï¼š<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">chcon</span> -R -t httpd_sys_content_t /var/www/html<br></code></pre></td></tr></table></figure></li></ul><h3 id="SSL-è¯ä¹¦é”™è¯¯"><a href="#SSL-è¯ä¹¦é”™è¯¯" class="headerlink" title="SSL è¯ä¹¦é”™è¯¯"></a>SSL è¯ä¹¦é”™è¯¯</h3><ul><li>éªŒè¯è¯ä¹¦æœ‰æ•ˆæœŸä¸è·¯å¾„ï¼š<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl x509 -<span class="hljs-keyword">in</span> www.example.com.crt -noout -dates -subject<br></code></pre></td></tr></table></figure></li></ul><h3 id="é‡å†™è§„åˆ™ä¸ç”Ÿæ•ˆ"><a href="#é‡å†™è§„åˆ™ä¸ç”Ÿæ•ˆ" class="headerlink" title="é‡å†™è§„åˆ™ä¸ç”Ÿæ•ˆ"></a>é‡å†™è§„åˆ™ä¸ç”Ÿæ•ˆ</h3><ul><li>æŸ¥çœ‹ <code>.htaccess</code> æƒé™</li><li>æŸ¥çœ‹é”™è¯¯æ—¥å¿— <code>/var/log/httpd/error_log</code></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>-Linxu -Apache</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxæ­å»ºå’Œé…ç½® NFSï¼ˆNetwork File Systemï¼‰(CentOS7)</title>
    <link href="/2025/05/09/Linux%E6%90%AD%E5%BB%BA%E5%92%8C%E9%85%8D%E7%BD%AE-NFS%EF%BC%88Network-File-System%EF%BC%89-CentOS7/"/>
    <url>/2025/05/09/Linux%E6%90%AD%E5%BB%BA%E5%92%8C%E9%85%8D%E7%BD%AE-NFS%EF%BC%88Network-File-System%EF%BC%89-CentOS7/</url>
    
    <content type="html"><![CDATA[<p>NFSç®€ä»‹:<br>    NFSï¼ˆNetwork File System ç½‘ç»œæ–‡ä»¶æœåŠ¡ï¼‰ï¼Œæ˜¯ä¸€ç§åŸºäº TCP&#x2F;IP ä¼ è¾“çš„ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿåè®®ï¼Œæœ€åˆç”± Sun å…¬å¸å¼€å‘ã€‚<br>NFS æœåŠ¡çš„å®ç°ä¾èµ–äº RPCï¼ˆRemote Process Callï¼Œè¿œç«¯è¿‡ç¨‹è°ƒç”¨ï¼‰æœºåˆ¶ï¼Œé€šè¿‡ä½¿ç”¨ NFS åè®®ï¼Œå®¢æˆ·æœºå¯ä»¥åƒè®¿é—®æœ¬åœ°ç›®å½•ä¸€æ ·è®¿é—®è¿œç¨‹æœåŠ¡å™¨ä¸­çš„å…±äº«èµ„æºã€‚ï¼ˆè¿œç«¯è¿‡ç¨‹è°ƒç”¨ï¼šè‡ªå·±æ²¡æœ‰è¿™ç§åŠŸèƒ½ï¼Œè°ƒç”¨åˆ«äººçš„åŠŸèƒ½ï¼‰ NFS ä¹Ÿæ˜¯ NAS å­˜å‚¨ è®¾å¤‡å¿…ç„¶æ”¯æŒçš„ä¸€ç§åè®®ï¼Œä»¥å®Œæˆè¿œç¨‹åˆ°æœ¬åœ°çš„æ˜ å°„è¿‡ç¨‹ã€‚(NASâ€”-Network Attached Storageï¼šç½‘ç»œé™„å±å­˜å‚¨NFSæ˜¯NASçš„ä¸€ç§)</p><h2 id="æœåŠ¡ç«¯é…ç½®"><a href="#æœåŠ¡ç«¯é…ç½®" class="headerlink" title="æœåŠ¡ç«¯é…ç½®:"></a>æœåŠ¡ç«¯é…ç½®:</h2><h3 id="1-å®‰è£…-NFS-æœåŠ¡"><a href="#1-å®‰è£…-NFS-æœåŠ¡" class="headerlink" title="1. å®‰è£… NFS æœåŠ¡"></a>1. å®‰è£… NFS æœåŠ¡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum install -y nfs-utils<br></code></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºå…±äº«ç›®å½•"><a href="#2-åˆ›å»ºå…±äº«ç›®å½•" class="headerlink" title="2.åˆ›å»ºå…±äº«ç›®å½•"></a>2.åˆ›å»ºå…±äº«ç›®å½•</h3><p>ç¡®ä¿æœåŠ¡å™¨ï¼ˆNFS Serverï¼‰ä¸å®¢æˆ·ç«¯ï¼ˆNFS Clientï¼‰èƒ½å¤Ÿç›¸äº’ ping é€šã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ping &lt;å¯¹æ–¹ip&gt;<br></code></pre></td></tr></table></figure><p>è‹¥pingä¸é€šå¯æ‰§è¡Œä»¥ä¸‹æ“ä½œ:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">setenforce 0 <span class="hljs-comment">#å…³é—­é˜²ç«å¢™å®‰å…¨æ¨¡å—</span><br>systemctl stop firewalld <span class="hljs-comment">#åœæ­¢é˜²ç«å¢™æœåŠ¡</span><br>systemctl <span class="hljs-built_in">disable</span> firewalld <span class="hljs-comment">#ç¦ç”¨å¼€æœºå¯åŠ¨é˜²ç«å¢™</span><br><span class="hljs-built_in">sudo</span> setenforce 0  <span class="hljs-comment">#ä¸´æ—¶å…³é—­ SELinux</span><br></code></pre></td></tr></table></figure><h3 id="3-åˆ›å»ºå…±äº«ç›®å½•"><a href="#3-åˆ›å»ºå…±äº«ç›®å½•" class="headerlink" title="3. åˆ›å»ºå…±äº«ç›®å½•"></a>3. åˆ›å»ºå…±äº«ç›®å½•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> -p /srv/nfs/shared<br><span class="hljs-built_in">chmod</span> 777 /srv/nfs/shared<br></code></pre></td></tr></table></figure><blockquote><p><strong>è§£é‡Š</strong>ï¼š</p><ul><li><code>mkdir -p</code>ï¼šåˆ›å»ºç›®å½•åŠå…¶ä¸Šçº§ç›®å½•ã€‚</li><li><code>chmod 777</code>ï¼šè®¾ç½®ç›®å½•ä¸ºæ‰€æœ‰ç”¨æˆ·å¯è¯»å†™æ‰§è¡Œï¼ˆæµ‹è¯•ç¯å¢ƒä½¿ç”¨ï¼Œç”Ÿäº§å¯æ ¹æ®éœ€è¦æ”¶ç´§æƒé™ï¼‰ã€‚</li></ul></blockquote><h3 id="4-ç¼–è¾‘å¯¼å‡ºé…ç½®"><a href="#4-ç¼–è¾‘å¯¼å‡ºé…ç½®" class="headerlink" title="4. ç¼–è¾‘å¯¼å‡ºé…ç½®"></a>4. ç¼–è¾‘å¯¼å‡ºé…ç½®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> &gt;&gt; /etc/exports &lt;&lt; <span class="hljs-string">EOF</span><br><span class="hljs-string">/srv/nfs/shared   192.168.1.0/24(rw,no_root_squash,sync)</span><br><span class="hljs-string">EOF</span><br></code></pre></td></tr></table></figure><blockquote><p><strong>è§£é‡Š</strong>ï¼š</p><ul><li><code>/srv/nfs/shared</code>ï¼šæœ¬åœ°è¦å…±äº«çš„ç›®å½•ã€‚</li><li><code>192.168.1.0/24</code>ï¼šå…è®¸è®¿é—®çš„å®¢æˆ·ç«¯ç½‘æ®µï¼ˆå¯æ”¹ä¸ºå• IPï¼Œå¦‚ <code>192.168.1.100</code>ï¼‰ã€‚</li><li><code>rw</code>ï¼šå…è®¸è¯»å†™ã€‚</li><li><code>no_root_squash</code>ï¼šå®¢æˆ·ç«¯ä»¥ root èº«ä»½è®¿é—®æ—¶ï¼Œä¸æ˜ å°„ä¸ºåŒ¿åç”¨æˆ·ï¼ˆæ…ç”¨ï¼‰ã€‚</li><li><code>sync</code>ï¼šå†™æ“ä½œä»¥åŒæ­¥æ–¹å¼è¿›è¡Œï¼Œä¿è¯æ•°æ®å®Œæ•´æ€§ã€‚</li></ul></blockquote><h3 id="5-å¯åŠ¨å¹¶è®¾ç½®æœåŠ¡å¼€æœºè‡ªå¯"><a href="#5-å¯åŠ¨å¹¶è®¾ç½®æœåŠ¡å¼€æœºè‡ªå¯" class="headerlink" title="5. å¯åŠ¨å¹¶è®¾ç½®æœåŠ¡å¼€æœºè‡ªå¯"></a>5. å¯åŠ¨å¹¶è®¾ç½®æœåŠ¡å¼€æœºè‡ªå¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">systemctl <span class="hljs-built_in">enable</span> --now nfs-server<br>systemctl <span class="hljs-built_in">enable</span> --now rpcbind<br></code></pre></td></tr></table></figure><blockquote><p><strong>è§£é‡Š</strong>ï¼š</p><ul><li><code>nfs-server</code>ï¼šNFS æœåŠ¡ä¸»ä½“ã€‚</li><li><code>rpcbind</code>ï¼šRPC æœåŠ¡æ¡†æ¶ï¼Œå¯¹ NFS å·¥ä½œå¿…éœ€ã€‚</li><li><code>--now</code>ï¼šç«‹å³å¯åŠ¨å¹¶å¼€æœºè‡ªå¯ã€‚</li></ul></blockquote><h3 id="6-åˆ·æ–°å¯¼å‡ºè¡¨å¹¶æŸ¥çœ‹"><a href="#6-åˆ·æ–°å¯¼å‡ºè¡¨å¹¶æŸ¥çœ‹" class="headerlink" title="6. åˆ·æ–°å¯¼å‡ºè¡¨å¹¶æŸ¥çœ‹"></a>6. åˆ·æ–°å¯¼å‡ºè¡¨å¹¶æŸ¥çœ‹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">exportfs -r<br>exportfs -v<br></code></pre></td></tr></table></figure><blockquote><p><strong>è§£é‡Š</strong>ï¼š</p><ul><li><code>exportfs -r</code>ï¼šé‡æ–°å¯¼å‡º <code>/etc/exports</code> ä¸­çš„æ‰€æœ‰æ¡ç›®ã€‚</li><li><code>exportfs -v</code>ï¼šæŸ¥çœ‹å½“å‰å¯¼å‡ºçš„å…±äº«åŠå…¶é€‰é¡¹ã€‚</li></ul></blockquote><h2 id="å®¢æˆ·ç«¯é…ç½®"><a href="#å®¢æˆ·ç«¯é…ç½®" class="headerlink" title="å®¢æˆ·ç«¯é…ç½®:"></a>å®¢æˆ·ç«¯é…ç½®:</h2><h3 id="1-å®‰è£…-NFS-å®¢æˆ·ç«¯å·¥å…·"><a href="#1-å®‰è£…-NFS-å®¢æˆ·ç«¯å·¥å…·" class="headerlink" title="1. å®‰è£… NFS å®¢æˆ·ç«¯å·¥å…·"></a>1. å®‰è£… NFS å®¢æˆ·ç«¯å·¥å…·</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum install -y nfs-utils<br></code></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºæŒ‚è½½ç‚¹"><a href="#2-åˆ›å»ºæŒ‚è½½ç‚¹" class="headerlink" title="2. åˆ›å»ºæŒ‚è½½ç‚¹"></a>2. åˆ›å»ºæŒ‚è½½ç‚¹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> -p /mnt/nfs/shared<br></code></pre></td></tr></table></figure><h3 id="3-æ‰‹åŠ¨æŒ‚è½½ï¼ˆæµ‹è¯•ï¼‰"><a href="#3-æ‰‹åŠ¨æŒ‚è½½ï¼ˆæµ‹è¯•ï¼‰" class="headerlink" title="3. æ‰‹åŠ¨æŒ‚è½½ï¼ˆæµ‹è¯•ï¼‰"></a>3. æ‰‹åŠ¨æŒ‚è½½ï¼ˆæµ‹è¯•ï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mount -t nfs 192.168.1.10:/srv/nfs/shared /mnt/nfs/shared<br></code></pre></td></tr></table></figure><blockquote><p><strong>è§£é‡Š</strong>ï¼š</p><ul><li><code>-t nfs</code>ï¼šæŒ‡å®šæ–‡ä»¶ç³»ç»Ÿç±»å‹ä¸º NFSã€‚</li><li><code>192.168.1.10:/srv/nfs/shared</code>ï¼šæœåŠ¡ç«¯ IP ä¸å¯¼å‡ºç›®å½•ã€‚</li><li><code>/mnt/nfs/shared</code>ï¼šæœ¬åœ°æŒ‚è½½ç‚¹ã€‚</li></ul></blockquote><p><strong>éªŒè¯æŒ‚è½½ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">df</span> -h | grep nfs<br>showmount -e 192.168.1.10<br></code></pre></td></tr></table></figure><h3 id="4-æŒä¹…åŒ–æŒ‚è½½ï¼ˆå¼€æœºè‡ªåŠ¨æŒ‚è½½ï¼‰"><a href="#4-æŒä¹…åŒ–æŒ‚è½½ï¼ˆå¼€æœºè‡ªåŠ¨æŒ‚è½½ï¼‰" class="headerlink" title="4. æŒä¹…åŒ–æŒ‚è½½ï¼ˆå¼€æœºè‡ªåŠ¨æŒ‚è½½ï¼‰"></a>4. æŒä¹…åŒ–æŒ‚è½½ï¼ˆå¼€æœºè‡ªåŠ¨æŒ‚è½½ï¼‰</h3><p>ç¼–è¾‘ <code>/etc/fstab</code>ï¼Œæ·»åŠ ä¸€è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">192.168.1.10:/srv/nfs/shared   /mnt/nfs/shared   nfs   defaults,_netdev  0 0<br></code></pre></td></tr></table></figure><blockquote><p><strong>è§£é‡Š</strong>ï¼š</p><ul><li><code>defaults</code>ï¼šä½¿ç”¨é»˜è®¤æŒ‚è½½é€‰é¡¹ï¼ˆrw, suid, dev, exec, auto, nouser, asyncï¼‰ã€‚</li><li><code>_netdev</code>ï¼šè¡¨ç¤ºç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨ç½‘ç»œèµ·åå†æŒ‚è½½ï¼Œé˜²æ­¢å¼€æœºæ—¶ç½‘ç»œæœªå°±ç»ªå¯¼è‡´æŒ‚è½½å¤±è´¥ã€‚</li></ul></blockquote><p>ç„¶åæ‰§è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mount -a<br></code></pre></td></tr></table></figure><p>æ£€æŸ¥æ— è¯¯å³å¯ã€‚</p><hr><h2 id="å››ã€æµ‹è¯•"><a href="#å››ã€æµ‹è¯•" class="headerlink" title="å››ã€æµ‹è¯•"></a>å››ã€æµ‹è¯•</h2><ol><li><p><strong>è¯»å†™æµ‹è¯•</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;hello NFS&quot;</span> &gt; /mnt/nfs/shared/test.txt<br><span class="hljs-built_in">cat</span> /mnt/nfs/shared/test.txt<br></code></pre></td></tr></table></figure></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>-Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ­å»ºç£ç›˜é˜µåˆ—ï¼ˆRAIDï¼‰</title>
    <link href="/2025/04/29/%E6%90%AD%E5%BB%BA%E7%A3%81%E7%9B%98%E9%98%B5%E5%88%97%EF%BC%88RAID%EF%BC%89/"/>
    <url>/2025/04/29/%E6%90%AD%E5%BB%BA%E7%A3%81%E7%9B%98%E9%98%B5%E5%88%97%EF%BC%88RAID%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ§©-Linux-RAID-é…ç½®æ•™ç¨‹ï¼ˆCentOS-7ï¼‰"><a href="#ğŸ§©-Linux-RAID-é…ç½®æ•™ç¨‹ï¼ˆCentOS-7ï¼‰" class="headerlink" title="ğŸ§© Linux RAID é…ç½®æ•™ç¨‹ï¼ˆCentOS 7ï¼‰"></a>ğŸ§© Linux RAID é…ç½®æ•™ç¨‹ï¼ˆCentOS 7ï¼‰</h1><blockquote><p>æœ¬æ–‡æ¶µç›– RAID 0ã€RAID 1ã€RAID 5ã€RAID 10 çš„å®ç°æ­¥éª¤ã€æ•…éšœç›˜å¤„ç†æŠ€å·§ã€‚</p></blockquote><h2 id="ğŸ”§-å‡†å¤‡å·¥ä½œ"><a href="#ğŸ”§-å‡†å¤‡å·¥ä½œ" class="headerlink" title="ğŸ”§ å‡†å¤‡å·¥ä½œ"></a>ğŸ”§ å‡†å¤‡å·¥ä½œ</h2><ol><li><p>å®‰è£… RAID å·¥å…·ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum install -y mdadm<br></code></pre></td></tr></table></figure></li><li><p>å‡†å¤‡è‡³å°‘ 2 å—ä»¥ä¸Šæœªåˆ†åŒºçš„æ–°ç¡¬ç›˜ï¼ˆå¦‚ <code>/dev/sdb</code>, <code>/dev/sdc</code> â€¦ï¼‰ã€‚</p></li></ol><h2 id="ğŸ“€-RAID-0ï¼šæ¡å¸¦åŒ–ï¼ˆæ— å†—ä½™ï¼‰"><a href="#ğŸ“€-RAID-0ï¼šæ¡å¸¦åŒ–ï¼ˆæ— å†—ä½™ï¼‰" class="headerlink" title="ğŸ“€ RAID 0ï¼šæ¡å¸¦åŒ–ï¼ˆæ— å†—ä½™ï¼‰"></a>ğŸ“€ RAID 0ï¼šæ¡å¸¦åŒ–ï¼ˆæ— å†—ä½™ï¼‰</h2><h3 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><ul><li>è‡³å°‘ 2 å—ç›˜</li><li>æ€§èƒ½å¥½</li><li>ä¸å…·å¤‡å®¹é”™èƒ½åŠ›ï¼ˆä»»æ„ç›˜æŸåå…¨éƒ¨æ•°æ®ä¸¢å¤±ï¼‰</li></ul><h3 id="å®ç°æ­¥éª¤"><a href="#å®ç°æ­¥éª¤" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">mdadm --create /dev/md0 --level=0 --raid-devices=2 /dev/sdb /dev/sdc<br>mkfs.ext4 /dev/md0<br><span class="hljs-built_in">mkdir</span> /mnt/raid0<br>mount /dev/md0 /mnt/raid0<br>mdadm --detail --scan &gt;&gt; /etc/mdadm.conf<br>blkid /dev/md0  <span class="hljs-comment"># åŠ å…¥ /etc/fstab</span><br></code></pre></td></tr></table></figure><h2 id="ğŸ›¡ï¸-RAID-1ï¼šé•œåƒ"><a href="#ğŸ›¡ï¸-RAID-1ï¼šé•œåƒ" class="headerlink" title="ğŸ›¡ï¸ RAID 1ï¼šé•œåƒ"></a>ğŸ›¡ï¸ RAID 1ï¼šé•œåƒ</h2><h3 id="ç‰¹ç‚¹-1"><a href="#ç‰¹ç‚¹-1" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><ul><li>è‡³å°‘ 2 å—ç›˜</li><li>æ•°æ®å®Œå…¨å¤åˆ¶</li><li>å¯å®¹å¿ 1 å—ç›˜æ•…éšœ</li><li>å†™æ€§èƒ½è¾ƒå·®ï¼Œä½†è¯»æ€§èƒ½ä¼˜ç§€</li></ul><h3 id="å®ç°æ­¥éª¤-1"><a href="#å®ç°æ­¥éª¤-1" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">mdadm --create /dev/md0 --level=1 --raid-devices=2 /dev/sdb /dev/sdc<br>mkfs.ext4 /dev/md0<br><span class="hljs-built_in">mkdir</span> /mnt/raid1<br>mount /dev/md0 /mnt/raid1<br>mdadm --detail --scan &gt;&gt; /etc/mdadm.conf<br>blkid /dev/md0<br></code></pre></td></tr></table></figure><h2 id="ğŸ“Š-RAID-5ï¼šå¸¦å¥‡å¶æ ¡éªŒçš„æ¡å¸¦åŒ–"><a href="#ğŸ“Š-RAID-5ï¼šå¸¦å¥‡å¶æ ¡éªŒçš„æ¡å¸¦åŒ–" class="headerlink" title="ğŸ“Š RAID 5ï¼šå¸¦å¥‡å¶æ ¡éªŒçš„æ¡å¸¦åŒ–"></a>ğŸ“Š RAID 5ï¼šå¸¦å¥‡å¶æ ¡éªŒçš„æ¡å¸¦åŒ–</h2><h3 id="ç‰¹ç‚¹-2"><a href="#ç‰¹ç‚¹-2" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><ul><li>è‡³å°‘ 3 å—ç›˜</li><li>å¥‡å¶æ ¡éªŒä¿è¯å®¹é”™</li><li>å¯å®¹å¿ 1 å—ç›˜æ•…éšœ</li></ul><h3 id="å®ç°æ­¥éª¤-2"><a href="#å®ç°æ­¥éª¤-2" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">mdadm --create /dev/md0 --level=5 --raid-devices=3 /dev/sdb /dev/sdc /dev/sdd<br>mkfs.ext4 /dev/md0<br><span class="hljs-built_in">mkdir</span> /mnt/raid5<br>mount /dev/md0 /mnt/raid5<br>mdadm --detail --scan &gt;&gt; /etc/mdadm.conf<br>blkid /dev/md0<br></code></pre></td></tr></table></figure><h3 id="æ•…éšœæ¨¡æ‹Ÿä¸æ¢å¤"><a href="#æ•…éšœæ¨¡æ‹Ÿä¸æ¢å¤" class="headerlink" title="æ•…éšœæ¨¡æ‹Ÿä¸æ¢å¤"></a>æ•…éšœæ¨¡æ‹Ÿä¸æ¢å¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">mdadm --fail /dev/md0 /dev/sdc<br>mdadm --remove /dev/md0 /dev/sdc<br>mdadm --add /dev/md0 /dev/sde<br></code></pre></td></tr></table></figure><h2 id="âš™ï¸-RAID-10ï¼šé•œåƒ-æ¡å¸¦"><a href="#âš™ï¸-RAID-10ï¼šé•œåƒ-æ¡å¸¦" class="headerlink" title="âš™ï¸ RAID 10ï¼šé•œåƒ + æ¡å¸¦"></a>âš™ï¸ RAID 10ï¼šé•œåƒ + æ¡å¸¦</h2><h3 id="ç‰¹ç‚¹-3"><a href="#ç‰¹ç‚¹-3" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><ul><li>è‡³å°‘ 4 å—ç›˜</li><li>æŠŠç›˜ä¸¤ä¸¤ç»„æˆé•œåƒï¼Œå†æ¡å¸¦åŒ–</li><li>é«˜æ€§èƒ½ + é«˜å†—ä½™ï¼Œè¯»å†™éƒ½å¿«</li><li>å¯å®¹å¿æ¯ç»„æŸå¤±ä¸€å—ç›˜</li></ul><h3 id="å®ç°æ­¥éª¤-3"><a href="#å®ç°æ­¥éª¤-3" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">mdadm --create /dev/md0 --level=10 --raid-devices=4 /dev/sdb /dev/sdc /dev/sdd /dev/sde<br>mkfs.ext4 /dev/md0<br><span class="hljs-built_in">mkdir</span> /mnt/raid10<br>mount /dev/md0 /mnt/raid10<br>mdadm --detail --scan &gt;&gt; /etc/mdadm.conf<br>blkid /dev/md0<br></code></pre></td></tr></table></figure><h2 id="âš ï¸-æ•…éšœç›˜å¤„ç†é€šç”¨å‘½ä»¤"><a href="#âš ï¸-æ•…éšœç›˜å¤„ç†é€šç”¨å‘½ä»¤" class="headerlink" title="âš ï¸ æ•…éšœç›˜å¤„ç†é€šç”¨å‘½ä»¤"></a>âš ï¸ æ•…éšœç›˜å¤„ç†é€šç”¨å‘½ä»¤</h2><ul><li><p>æŸ¥çœ‹çŠ¶æ€ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /proc/mdstat<br>mdadm --detail /dev/md0<br></code></pre></td></tr></table></figure></li><li><p>æ ‡è®°æŸç›˜ä¸ºæ•…éšœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mdadm --fail /dev/md0 /dev/sdX<br></code></pre></td></tr></table></figure></li><li><p>ç§»é™¤ç›˜ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mdadm --remove /dev/md0 /dev/sdX<br></code></pre></td></tr></table></figure></li><li><p>æ·»åŠ æ–°ç›˜ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mdadm --add /dev/md0 /dev/sdY<br></code></pre></td></tr></table></figure></li></ul><h2 id="ğŸ“Œ-RAID-å¯¹æ¯”è¡¨"><a href="#ğŸ“Œ-RAID-å¯¹æ¯”è¡¨" class="headerlink" title="ğŸ“Œ RAID å¯¹æ¯”è¡¨"></a>ğŸ“Œ RAID å¯¹æ¯”è¡¨</h2><table><thead><tr><th>RAIDçº§åˆ«</th><th>æœ€å°‘ç›˜æ•°</th><th>å®¹é”™èƒ½åŠ›</th><th>è¯»æ€§èƒ½</th><th>å†™æ€§èƒ½</th><th>å®¹é‡åˆ©ç”¨ç‡</th><th>åº”ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>RAID 0</td><td>2</td><td>æ— </td><td>é«˜</td><td>é«˜</td><td>100%</td><td>é«˜é€Ÿç¼“å­˜ã€ä¸´æ—¶æ•°æ®</td></tr><tr><td>RAID 1</td><td>2</td><td>å¯å®¹å¿1å—</td><td>é«˜</td><td>ä½</td><td>50%</td><td>ç³»ç»Ÿç›˜ã€é‡è¦æ•°æ®</td></tr><tr><td>RAID 5</td><td>3</td><td>å¯å®¹å¿1å—</td><td>é«˜</td><td>ä¸­</td><td>(N-1)&#x2F;N</td><td>ä¸€èˆ¬å­˜å‚¨æœåŠ¡å™¨</td></tr><tr><td>RAID 10</td><td>4</td><td>æ¯ç»„å®¹å¿1å—</td><td>é«˜</td><td>é«˜</td><td>50%</td><td>æ•°æ®åº“ã€IOå¯†é›†å‹åº”ç”¨</td></tr></tbody></table><h2 id="âœ…-RAID-è®¾å¤‡å¼€æœºè‡ªåŠ¨æŒ‚è½½æ€»ç»“"><a href="#âœ…-RAID-è®¾å¤‡å¼€æœºè‡ªåŠ¨æŒ‚è½½æ€»ç»“" class="headerlink" title="âœ… RAID è®¾å¤‡å¼€æœºè‡ªåŠ¨æŒ‚è½½æ€»ç»“"></a>âœ… RAID è®¾å¤‡å¼€æœºè‡ªåŠ¨æŒ‚è½½æ€»ç»“</h2><ol><li><p>è·å– UUIDï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">blkid /dev/md0<br></code></pre></td></tr></table></figure></li><li><p>ç¼–è¾‘ <code>/etc/fstab</code>ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">UUID</span><span class="hljs-operator">=</span>xxxx-xxxx /mnt/raidX ext4 defaults <span class="hljs-number">0</span> <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure></li><li><p>ä¿å­˜ RAID é…ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mdadm --detail --scan &gt;&gt; /etc/mdadm.conf<br></code></pre></td></tr></table></figure></li></ol><h2 id="ğŸ“-å‚è€ƒå‘½ä»¤é€ŸæŸ¥"><a href="#ğŸ“-å‚è€ƒå‘½ä»¤é€ŸæŸ¥" class="headerlink" title="ğŸ“ å‚è€ƒå‘½ä»¤é€ŸæŸ¥"></a>ğŸ“ å‚è€ƒå‘½ä»¤é€ŸæŸ¥</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">mdadm --create ...<br>mdadm --detail /dev/md0<br>mdadm --fail ...<br>mdadm --remove ...<br>mdadm --add ...<br>mkfs.ext4 /dev/md0<br>mount /dev/md0 /mnt/xxx<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>RAID</tag>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Spring-Cloudå…¥é—¨å­¦ä¹ </title>
    <link href="/2025/02/21/Spring-Cloud%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/"/>
    <url>/2025/02/21/Spring-Cloud%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>é˜¿é‡Œäº‘æœåŠ¡å™¨é…ç½®å°è®°</title>
    <link href="/2024/12/07/%E9%98%BF%E9%87%8C%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE%E5%B0%8F%E8%AE%B0/"/>
    <url>/2024/12/07/%E9%98%BF%E9%87%8C%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE%E5%B0%8F%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p>ç”±äºä¸€å¹´å‰è´­ä¹°çš„è…¾è®¯äº‘æœåŠ¡å™¨è¿‡æœŸ,è€ƒè™‘è´­å…¥ä¸€å°é˜¿é‡Œäº‘æœåŠ¡å™¨,ä½¿ç”¨é˜¿é‡Œäº‘å­¦ç”Ÿä¼˜æƒ :<a href="https://university.aliyun.com/">é˜¿é‡Œäº‘é«˜æ ¡è®¡åˆ’_äº‘å·¥å¼€ç‰©_åŠ©åŠ›é«˜æ ¡ç§‘ç ”ä¸æ•™è‚²åŠ é€Ÿ-é˜¿é‡Œäº‘</a>åä»·æ ¼é«˜è¾¾0å…ƒ.</p><p><img src="/images/a1.png"></p><p>è™½ç„¶ä¹‹å‰çš„è…¾è®¯äº‘æœåŠ¡å™¨ç”±äºå†…å­˜ä¸è¶³æ›´æ–°å¼•å…¥è½¯ä»¶æºå¤±è´¥,ä½†å›Šä¸­ç¾æ¶©é…ç½®ä¾æ—§æ˜¯2æ ¸2G.</p><p>é¦–å…ˆæ”¾é€šä¸€ä¸‹å®‰å…¨ç»„,å®‰è£…docker,1Panel,,å®å¡”é¢æ¿ä¸ªäººä½¿ç”¨å¤ªéº»çƒ¦äº†.ä¸€å¼€å§‹å°±è¸©äº†ä¸ªå¤§å‘,æœåŠ¡å™¨æ— æ³•è®¿é—®å¤–ç½‘,ä¸€çœ‹å…¬ç½‘ipéƒ½æ²¡æœ‰,ç™¾æ€ä¸å¾—å…¶è§£,åæ¥å‘ç°æ˜¯åˆ›å»ºå®ä¾‹çš„æ—¶å€™å¿…é¡»å‹¾é€‰å®½å¸¦.</p><p><img src="/images/a2.png"></p><p>é…ç½®å¥½åå…ˆéƒ¨ç½²ç¬¬ä¸€ä¸ªé¡¹ç›®,<a href="https://github.com/code-brown/YesPlayMusic">code-brown&#x2F;YesPlayMusic: é«˜é¢œå€¼çš„ç¬¬ä¸‰æ–¹ç½‘æ˜“äº‘æ’­æ”¾å™¨</a>,é…ç½®å®‰è£…node.js,å‘ç°éœ€è¦14 || 16 nodejsç‰ˆæœ¬,å®‰è£…nvm,åˆ‡æ¢åˆ°16ç‰ˆæœ¬åå®‰è£…ä¾èµ–æ„å»º.</p>]]></content>
    
    
    
    <tags>
      
      <tag>-æœåŠ¡å™¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MyBatis-Plusä½¿ç”¨å…¥é—¨</title>
    <link href="/2024/12/04/MyBatis-Plus%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8/"/>
    <url>/2024/12/04/MyBatis-Plus%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<p>MyBatis-Pluså®˜ç½‘:<a href="https://baomidou.com/">MyBatis-Plus ğŸš€ ä¸ºç®€åŒ–å¼€å‘è€Œç”Ÿ</a></p><p><a href="https://github.com/baomidou/mybatis-plus">MyBatis-Plus</a> æ˜¯ä¸€ä¸ª <a href="https://www.mybatis.org/mybatis-3/">MyBatis</a> çš„å¢å¼ºå·¥å…·ï¼Œåœ¨ MyBatis çš„åŸºç¡€ä¸Šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œä¸ºç®€åŒ–å¼€å‘ã€æé«˜æ•ˆç‡è€Œç”Ÿã€‚</p><h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><ul><li><strong>æ— ä¾µå…¥</strong>ï¼šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œå¼•å…¥å®ƒä¸ä¼šå¯¹ç°æœ‰å·¥ç¨‹äº§ç”Ÿå½±å“ï¼Œå¦‚ä¸èˆ¬é¡ºæ»‘</li><li><strong>æŸè€—å°</strong>ï¼šå¯åŠ¨å³ä¼šè‡ªåŠ¨æ³¨å…¥åŸºæœ¬ CURDï¼Œæ€§èƒ½åŸºæœ¬æ— æŸè€—ï¼Œç›´æ¥é¢å‘å¯¹è±¡æ“ä½œ</li><li><strong>å¼ºå¤§çš„ CRUD æ“ä½œ</strong>ï¼šå†…ç½®é€šç”¨ Mapperã€é€šç”¨ Serviceï¼Œä»…ä»…é€šè¿‡å°‘é‡é…ç½®å³å¯å®ç°å•è¡¨å¤§éƒ¨åˆ† CRUD æ“ä½œï¼Œæ›´æœ‰å¼ºå¤§çš„æ¡ä»¶æ„é€ å™¨ï¼Œæ»¡è¶³å„ç±»ä½¿ç”¨éœ€æ±‚</li><li><strong>æ”¯æŒ Lambda å½¢å¼è°ƒç”¨</strong>ï¼šé€šè¿‡ Lambda è¡¨è¾¾å¼ï¼Œæ–¹ä¾¿çš„ç¼–å†™å„ç±»æŸ¥è¯¢æ¡ä»¶ï¼Œæ— éœ€å†æ‹…å¿ƒå­—æ®µå†™é”™</li><li><strong>æ”¯æŒä¸»é”®è‡ªåŠ¨ç”Ÿæˆ</strong>ï¼šæ”¯æŒå¤šè¾¾ 4 ç§ä¸»é”®ç­–ç•¥ï¼ˆå†…å«åˆ†å¸ƒå¼å”¯ä¸€ ID ç”Ÿæˆå™¨ - Sequenceï¼‰ï¼Œå¯è‡ªç”±é…ç½®ï¼Œå®Œç¾è§£å†³ä¸»é”®é—®é¢˜</li><li><strong>æ”¯æŒ ActiveRecord æ¨¡å¼</strong>ï¼šæ”¯æŒ ActiveRecord å½¢å¼è°ƒç”¨ï¼Œå®ä½“ç±»åªéœ€ç»§æ‰¿ Model ç±»å³å¯è¿›è¡Œå¼ºå¤§çš„ CRUD æ“ä½œ</li><li><strong>æ”¯æŒè‡ªå®šä¹‰å…¨å±€é€šç”¨æ“ä½œ</strong>ï¼šæ”¯æŒå…¨å±€é€šç”¨æ–¹æ³•æ³¨å…¥ï¼ˆ Write once, use anywhere ï¼‰</li><li><strong>å†…ç½®ä»£ç ç”Ÿæˆå™¨</strong>ï¼šé‡‡ç”¨ä»£ç æˆ–è€… Maven æ’ä»¶å¯å¿«é€Ÿç”Ÿæˆ Mapper ã€ Model ã€ Service ã€ Controller å±‚ä»£ç ï¼Œæ”¯æŒæ¨¡æ¿å¼•æ“ï¼Œæ›´æœ‰è¶…å¤šè‡ªå®šä¹‰é…ç½®ç­‰æ‚¨æ¥ä½¿ç”¨</li><li><strong>å†…ç½®åˆ†é¡µæ’ä»¶</strong>ï¼šåŸºäº MyBatis ç‰©ç†åˆ†é¡µï¼Œå¼€å‘è€…æ— éœ€å…³å¿ƒå…·ä½“æ“ä½œï¼Œé…ç½®å¥½æ’ä»¶ä¹‹åï¼Œå†™åˆ†é¡µç­‰åŒäºæ™®é€š List æŸ¥è¯¢</li><li><strong>åˆ†é¡µæ’ä»¶æ”¯æŒå¤šç§æ•°æ®åº“</strong>ï¼šæ”¯æŒ MySQLã€MariaDBã€Oracleã€DB2ã€H2ã€HSQLã€SQLiteã€Postgreã€SQLServer ç­‰å¤šç§æ•°æ®åº“</li><li><strong>å†…ç½®æ€§èƒ½åˆ†ææ’ä»¶</strong>ï¼šå¯è¾“å‡º SQL è¯­å¥ä»¥åŠå…¶æ‰§è¡Œæ—¶é—´ï¼Œå»ºè®®å¼€å‘æµ‹è¯•æ—¶å¯ç”¨è¯¥åŠŸèƒ½ï¼Œèƒ½å¿«é€Ÿæªå‡ºæ…¢æŸ¥è¯¢</li><li><strong>å†…ç½®å…¨å±€æ‹¦æˆªæ’ä»¶</strong>ï¼šæä¾›å…¨è¡¨ delete ã€ update æ“ä½œæ™ºèƒ½åˆ†æé˜»æ–­ï¼Œä¹Ÿå¯è‡ªå®šä¹‰æ‹¦æˆªè§„åˆ™ï¼Œé¢„é˜²è¯¯æ“ä½œ</li></ul><h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><h3 id="ä½¿ç”¨MBPåç«¯å®Œæˆcrudæ“ä½œ"><a href="#ä½¿ç”¨MBPåç«¯å®Œæˆcrudæ“ä½œ" class="headerlink" title="ä½¿ç”¨MBPåç«¯å®Œæˆcrudæ“ä½œ:"></a>ä½¿ç”¨MBPåç«¯å®Œæˆcrudæ“ä½œ:</h3><p>1.å¼•å…¥MyBatis-Plusä¾èµ–</p><p>2.åˆ›å»ºæ•°æ®åº“,é…ç½®æ•°æ®æº</p><p>3.åˆ›å»ºuserå®ä½“ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@TableName(&quot;user&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br>    <span class="hljs-meta">@TableId</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> id;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Date birthday;<br>    <span class="hljs-keyword">private</span> String address;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> gender;<br>&#125;<br></code></pre></td></tr></table></figure><p>4.åˆ›å»ºmapperæ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Mapper</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;User&gt; &#123;<br>&#125;<br></code></pre></td></tr></table></figure><p>5.åˆ›å»ºæœåŠ¡ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ServiceImpl</span>&lt;UserMapper, User&gt; &#123;<br>&#125;<br></code></pre></td></tr></table></figure><p>6.åˆ›å»ºæ§åˆ¶å™¨</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@CrossOrigin</span>(origins = <span class="hljs-string">&quot;http://localhost:XXXX&quot;</span>)<br><span class="hljs-variable">@RequestMapping</span>(<span class="hljs-string">&quot;/users&quot;</span>)<br><span class="hljs-variable">@RestController</span><br>public class Controller &#123;<br>    <span class="hljs-variable">@Autowired</span><br>    UserService userService;<br><br>    <span class="hljs-variable">@GetMapping</span><br>    public List&lt;User&gt; <span class="hljs-built_in">findAllUser</span>()&#123;<br>        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">userService</span><span class="hljs-selector-class">.list</span>();<br>    &#125;<br><br>    @<span class="hljs-selector-tag">PostMapping</span><br>    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">User</span> <span class="hljs-selector-tag">addUser</span>(<span class="hljs-variable">@RequestBody</span> User user)&#123;<br>        <span class="hljs-selector-tag">userService</span><span class="hljs-selector-class">.save</span>(user);<br>        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">user</span>; <span class="hljs-comment">// è¿”å›ä¿å­˜çš„ç”¨æˆ·å¯¹è±¡ï¼ŒåŒ…å«ç”Ÿæˆçš„ID</span><br>    &#125;<br><br>    @<span class="hljs-selector-tag">PutMapping</span>(<span class="hljs-string">&quot;/&#123;id&#125;&quot;</span>)<br>    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">boolean</span> <span class="hljs-selector-tag">updateUser</span>(<span class="hljs-variable">@RequestBody</span> User user, <span class="hljs-variable">@PathVariable</span> int id)&#123;<br>        <span class="hljs-selector-tag">user</span><span class="hljs-selector-class">.setId</span>(id); <span class="hljs-comment">// ç¡®ä¿æ›´æ–°çš„ç”¨æˆ·IDæ­£ç¡®</span><br>        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">userService</span><span class="hljs-selector-class">.updateById</span>(user);<br>    &#125;<br><br>    @<span class="hljs-selector-tag">DeleteMapping</span>(<span class="hljs-string">&quot;/&#123;id&#125;&quot;</span>)<br>    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">boolean</span> <span class="hljs-selector-tag">deleteUser</span>(<span class="hljs-variable">@PathVariable</span> int id) &#123;<br>        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">userService</span><span class="hljs-selector-class">.removeById</span>(id);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>7.å®Œæˆå¯¹åº”å‰ç«¯é¡µé¢:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div class=&quot;app&quot;&gt;<br>    &lt;h1&gt;ç”¨æˆ·åˆ—è¡¨&lt;/h1&gt;<br>    &lt;ul&gt;<br>      &lt;li v-for=&quot;user in users&quot; :key=&quot;user.id&quot; @click=&quot;selectUser(user)&quot; class=&quot;user-item&quot;&gt;<br>        &#123;&#123; user.name &#125;&#125;<br>      &lt;/li&gt;<br>      &lt;button @click=&quot;editSelectedUser&quot; :disabled=&quot;!selectedUser&quot; class=&quot;action-button&quot;&gt;ç¼–è¾‘ç”¨æˆ·&lt;/button&gt;<br>      &lt;button @click=&quot;deleteUser(selectedUser)&quot; :disabled=&quot;!selectedUser&quot; class=&quot;action-button&quot;&gt;åˆ é™¤ç”¨æˆ·&lt;/button&gt;<br>    &lt;/ul&gt;<br><br>    &lt;h2&gt;æ·»åŠ ç”¨æˆ·&lt;/h2&gt;<br>    &lt;form @submit.prevent=&quot;addUser&quot; class=&quot;user-form&quot;&gt;<br>      &lt;input type=&quot;text&quot; v-model=&quot;newUser.name&quot; placeholder=&quot;è¯·è¾“å…¥å§“å&quot; class=&quot;user-input&quot; required&gt;<br>      &lt;input type=&quot;date&quot; v-model=&quot;newUser.birthday&quot; placeholder=&quot;è¯·è¾“å…¥å‡ºç”Ÿæ—¥æœŸ&quot; class=&quot;user-input&quot; required&gt;<br>      &lt;input type=&quot;text&quot; v-model=&quot;newUser.address&quot; placeholder=&quot;è¯·è¾“å…¥åœ°å€&quot; class=&quot;user-input&quot; required&gt;<br>      &lt;select v-model=&quot;newUser.gender&quot; class=&quot;user-input&quot; required&gt;<br>        &lt;option value=&quot;&quot; disabled&gt;è¯·é€‰æ‹©æ€§åˆ«&lt;/option&gt;<br>        &lt;option value=&quot;1&quot;&gt;ç”·&lt;/option&gt;<br>        &lt;option value=&quot;2&quot;&gt;å¥³&lt;/option&gt;<br>      &lt;/select&gt;<br>      &lt;button type=&quot;submit&quot; class=&quot;submit-button&quot;&gt;æ·»åŠ ç”¨æˆ·&lt;/button&gt;<br>    &lt;/form&gt;<br><br>    &lt;h2 v-if=&quot;editingUser&quot;&gt;ç¼–è¾‘ç”¨æˆ·&lt;/h2&gt;<br>    &lt;form v-if=&quot;editingUser&quot; @submit.prevent=&quot;updateUser&quot; class=&quot;user-form&quot;&gt;<br>      &lt;input v-model=&quot;editingUser.name&quot; placeholder=&quot;è¯·è¾“å…¥å§“å&quot; class=&quot;user-input&quot; required&gt;<br>      &lt;input v-model=&quot;editingUser.birthday&quot; placeholder=&quot;è¯·è¾“å…¥å‡ºç”Ÿæ—¥æœŸ&quot; class=&quot;user-input&quot; required&gt;<br>      &lt;input v-model=&quot;editingUser.address&quot; placeholder=&quot;è¯·è¾“å…¥åœ°å€&quot; class=&quot;user-input&quot; required&gt;<br>      &lt;select v-model=&quot;editingUser.gender&quot; class=&quot;user-input&quot; required&gt;<br>        &lt;option value=&quot;1&quot;&gt;ç”·&lt;/option&gt;<br>        &lt;option value=&quot;2&quot;&gt;å¥³&lt;/option&gt;<br>      &lt;/select&gt;<br>      &lt;button type=&quot;submit&quot; class=&quot;submit-button&quot;&gt;ä¿å­˜&lt;/button&gt;<br>      &lt;button @click=&quot;cancelEdit&quot; class=&quot;cancel-button&quot;&gt;å–æ¶ˆ&lt;/button&gt;<br>    &lt;/form&gt;<br>  &lt;/div&gt;<br>&lt;/template&gt;<br><br>&lt;script&gt;<br>import axios from &#x27;axios&#x27;;<br><br>export default &#123;<br>  data() &#123;<br>    return &#123;<br>      users: [],<br>      newUser: &#123; name: &#x27;&#x27;, birthday: &#x27;&#x27;, address: &#x27;&#x27;, gender: &#x27;&#x27; &#125;,<br>      editingUser: null,<br>      selectedUser: null,<br>    &#125;;<br>  &#125;,<br>  created() &#123;<br>    this.fetchUsers();<br>  &#125;,<br>  methods: &#123;<br>    async fetchUsers() &#123;<br>      try &#123;<br>        const response = await axios.get(&#x27;http://localhost:8080/users&#x27;);<br>        this.users = response.data;<br>      &#125; catch (error) &#123;<br>        console.log(&quot;è·å–ç”¨æˆ·ä¿¡æ¯é”™è¯¯&quot;, error);<br>      &#125;<br>    &#125;,<br>    async addUser() &#123;<br>      if (!this.newUser.name || !this.newUser.birthday || !this.newUser.address || !this.newUser.gender) &#123;<br>        alert(&#x27;æ‰€æœ‰å­—æ®µå‡ä¸ºå¿…å¡«é¡¹&#x27;);<br>        return;<br>      &#125;<br>      try &#123;<br>        const response = await axios.post(&#x27;http://localhost:8080/users&#x27;, this.newUser);<br>        if (response.data) &#123;<br>          this.users.push(response.data);<br>          this.newUser = &#123; name: &#x27;&#x27;, birthday: &#x27;&#x27;, address: &#x27;&#x27;, gender: &#x27;&#x27; &#125;;<br>          await this.fetchUsers();  // æ·»åŠ ç”¨æˆ·ååˆ·æ–°åˆ—è¡¨<br>        &#125;<br>      &#125; catch (error) &#123;<br>        console.log(&quot;æ·»åŠ ç”¨æˆ·é”™è¯¯&quot;, error);<br>      &#125;<br>    &#125;,<br>    async updateUser() &#123;<br>      try &#123;<br>        const response = await axios.put(`http://localhost:8080/users/$&#123;this.editingUser.id&#125;`, this.editingUser);<br>        if (response.data) &#123;<br>          await this.fetchUsers();  // æ›´æ–°ç”¨æˆ·ååˆ·æ–°åˆ—è¡¨<br>          this.editingUser = null;<br>        &#125;<br>      &#125; catch (error) &#123;<br>        console.log(&quot;æ›´æ–°ç”¨æˆ·é”™è¯¯&quot;, error);<br>      &#125;<br>    &#125;,<br>    async deleteUser(user) &#123;<br>      if (!confirm(`ç¡®å®šè¦åˆ é™¤ç”¨æˆ· $&#123;user.name&#125; å—ï¼Ÿ`)) return;<br>      try &#123;<br>        const response = await axios.delete(`http://localhost:8080/users/$&#123;user.id&#125;`);<br>        if (response.status === 200) &#123;<br>          this.users = this.users.filter(u =&gt; u.id !== user.id);<br>        &#125;<br>      &#125; catch (error) &#123;<br>        console.log(&quot;åˆ é™¤ç”¨æˆ·é”™è¯¯&quot;, error);<br>      &#125;<br>    &#125;,<br>    selectUser(user) &#123;<br>      this.selectedUser = user;<br>    &#125;,<br>    editSelectedUser() &#123;<br>      if (this.selectedUser) &#123;<br>        this.editingUser = &#123; ...this.selectedUser &#125;;<br>      &#125;<br>    &#125;,<br>    cancelEdit() &#123;<br>      this.editingUser = null;<br>    &#125;,<br>  &#125;,<br>&#125;;<br>&lt;/script&gt;<br><br>&lt;style&gt;<br>.app &#123;<br>  font-family: Arial, sans-serif;<br>  margin: 20px;<br>  padding: 20px;<br>  border: 1px solid #ccc;<br>  border-radius: 8px;<br>  background-color: #f9f9f9;<br>&#125;<br><br>h1, h2 &#123;<br>  color: #333;<br>&#125;<br><br>ul &#123;<br>  list-style-type: none;<br>  padding: 0;<br>  margin-bottom: 20px;<br>&#125;<br><br>.user-item &#123;<br>  padding: 10px;<br>  margin: 5px 0;<br>  border: 1px solid #ddd;<br>  border-radius: 4px;<br>  cursor: pointer;<br>  transition: background-color 0.3s;<br>&#125;<br><br>.user-item:hover &#123;<br>  background-color: #e0e0e0;<br>&#125;<br><br>.action-button &#123;<br>  padding: 10px 20px;<br>  margin: 5px;<br>  border: none;<br>  border-radius: 4px;<br>  color: white;<br>  background-color: #007bff;<br>  cursor: pointer;<br>  transition: background-color 0.3s;<br>&#125;<br><br>.action-button:disabled &#123;<br>  background-color: #ccc;<br>  cursor: not-allowed;<br>&#125;<br><br>.action-button:hover:enabled &#123;<br>  background-color: #0056b3;<br>&#125;<br><br>.user-form &#123;<br>  margin-bottom: 20px;<br>&#125;<br><br>.user-input &#123;<br>  display: block;<br>  width: 100%;<br>  padding: 10px;<br>  margin-bottom: 10px;<br>  border: 1px solid #ddd;<br>  border-radius: 4px;<br>  box-sizing: border-box;<br>&#125;<br><br>.submit-button &#123;<br>  padding: 10px 20px;<br>  border: none;<br>  border-radius: 4px;<br>  color: white;<br>  background-color: #28a745;<br>  cursor: pointer;<br>  transition: background-color 0.3s;<br>&#125;<br><br>.submit-button:hover &#123;<br>  background-color: #218838;<br>&#125;<br><br>.cancel-button &#123;<br>  padding: 10px 20px;<br>  border: none;<br>  border-radius: 4px;<br>  color: white;<br>  background-color: #dc3545;<br>  cursor: pointer;<br>  transition: background-color 0.3s;<br>&#125;<br><br>.cancel-button:hover &#123;<br>  background-color: #c82333;<br>&#125;<br>&lt;/style&gt;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>-MyBatis -Spring</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mallé¡¹ç›®å­¦ä¹ è®°å½•</title>
    <link href="/2024/12/03/mall%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    <url>/2024/12/03/mall%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Mybatis-Generatorä½¿ç”¨é…ç½®</title>
    <link href="/2024/12/03/Mybatis-Generator%E4%BD%BF%E7%94%A8%E9%85%8D%E7%BD%AE/"/>
    <url>/2024/12/03/Mybatis-Generator%E4%BD%BF%E7%94%A8%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<p>MyBatis Generatorå®˜ç½‘:<a href="https://mybatis.org/generator/">MyBatis Generator Core â€“ Introduction to MyBatis Generator</a></p><p>MyBatis Generator ï¼ˆMBGï¼‰ æ˜¯ MyBatis å®˜æ–¹çš„ä»£ç ç”Ÿæˆå™¨ã€‚å®ƒèƒ½å¤Ÿæ ¹æ®æ•°æ®åº“è¡¨ï¼Œè‡ªåŠ¨ç”Ÿæˆ java å®ä½“ç±»ã€dao å±‚æ¥å£ï¼ˆmapper æ¥å£ï¼‰åŠmapper.xmlæ–‡ä»¶ã€‚è¿™å¤§å¤§å‡å°‘äº†æˆ‘ä»¬å»ºç«‹å®ä½“ç±»ã€dao æ¥å£åŠ mapper æ˜ å°„æ–‡ä»¶çš„ç¹çä»»åŠ¡ï¼Œå¯ä»¥èŠ‚çœå¾ˆå¤šæ—¶é—´ï¼Œä¸“æ³¨äºä¸šåŠ¡å±‚ä»£ç çš„å¼€å‘</p><p>é…ç½®æ­¥éª¤;</p><p>1.å¼•å…¥ä¾èµ–å’Œæ’ä»¶:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis.generator<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-generator-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.4.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br> <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis.generator<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3.7<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">configurationFile</span>&gt;</span>src/main/resources/generatorConfig.xml<span class="hljs-tag">&lt;/<span class="hljs-name">configurationFile</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">overwrite</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">overwrite</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">verbose</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">verbose</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">overwrite</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">overwrite</span>&gt;</span><br></code></pre></td></tr></table></figure><p>:è¿™ä¸ªé…ç½®é¡¹è¡¨ç¤ºå…è®¸è¦†ç›–å·²å­˜åœ¨çš„æ–‡ä»¶æˆ–èµ„æºã€‚å½“è®¾ç½®ä¸º true æ—¶ï¼Œå¦‚æœç›®æ ‡ä½ç½®å·²ç»å­˜åœ¨åŒåçš„æ–‡ä»¶æˆ–èµ„æºï¼Œå°†ä¼šè¢«æ–°æ–‡ä»¶æˆ–èµ„æºè¦†ç›–ã€‚</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">&lt;<span class="hljs-built_in">verbose</span>&gt;<span class="hljs-literal">true</span>&lt;/<span class="hljs-built_in">verbose</span>&gt;<br></code></pre></td></tr></table></figure><p>:è¿™ä¸ªé…ç½®é¡¹è¡¨ç¤ºå¯ç”¨è¯¦ç»†è¾“å‡ºæ¨¡å¼ã€‚å½“è®¾ç½®ä¸º true æ—¶ï¼Œç¨‹åºæˆ–å·¥å…·å°†è¾“å‡ºæ›´å¤šçš„è¿è¡Œæ—¶ä¿¡æ¯ï¼Œé€šå¸¸ç”¨äºè°ƒè¯•æˆ–è¯¦ç»†æ—¥å¿—è®°å½•ï¼Œå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°äº†è§£ç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹ã€‚</p><p>å®æµ‹1.4.2ç‰ˆæœ¬çš„mybatis-generator-maven-pluginä¸8.2.0é«˜ç‰ˆæœ¬çš„MySQLä¼šå‡ºç°å…¼å®¹é—®é¢˜,æç¤º</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs verilog">rg<span class="hljs-variable">.mybatis</span><span class="hljs-variable">.generator</span>:mybatis-generator-maven-plugin:<span class="hljs-number">1</span><span class="hljs-variable">.4</span><span class="hljs-variable">.2</span>:<span class="hljs-keyword">generate</span> (<span class="hljs-keyword">default</span>-cli) on project spring-mbg: Execution <span class="hljs-keyword">default</span>-cli of goal org<span class="hljs-variable">.mybatis</span><span class="hljs-variable">.generator</span>:mybatis-generator-maven-plugin:<span class="hljs-number">1</span><span class="hljs-variable">.4</span><span class="hljs-variable">.2</span>:<span class="hljs-keyword">generate</span> failed: Exception getting JDBC Driver: com<span class="hljs-variable">.mysql</span><span class="hljs-variable">.cj</span><span class="hljs-variable">.jdbc</span><span class="hljs-variable">.Driver</span><br></code></pre></td></tr></table></figure><p>å› æ­¤æš‚æ—¶é™ä½ç‰ˆæœ¬ä½¿ç”¨;</p><p>2.é…ç½®generatorConfigæ–‡ä»¶:</p><p>æ¨¡æ¿å¯åœ¨mybatis generatorå®˜ç½‘æ‰¾åˆ°:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">generatorConfiguration</span> <span class="hljs-keyword">PUBLIC</span></span><br><span class="hljs-meta"> <span class="hljs-string">&quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot;</span></span><br><span class="hljs-meta"> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">generatorConfiguration</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">context</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;simple&quot;</span> <span class="hljs-attr">targetRuntime</span>=<span class="hljs-string">&quot;MyBatis3&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">jdbcConnection</span> <span class="hljs-attr">driverClass</span>=<span class="hljs-string">&quot;org.hsqldb.jdbcDriver&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">connectionURL</span>=<span class="hljs-string">&quot;jdbc:hsqldb:mem:aname&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">userId</span>=<span class="hljs-string">&quot;username&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">password</span>=<span class="hljs-string">&quot;password&quot;</span>/&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">javaModelGenerator</span> <span class="hljs-attr">targetPackage</span>=<span class="hljs-string">&quot;example.model&quot;</span> <span class="hljs-attr">targetProject</span>=<span class="hljs-string">&quot;src/main/java&quot;</span>/&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">sqlMapGenerator</span> <span class="hljs-attr">targetPackage</span>=<span class="hljs-string">&quot;example.mapper&quot;</span> <span class="hljs-attr">targetProject</span>=<span class="hljs-string">&quot;src/main/resources&quot;</span>/&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">javaClientGenerator</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;XMLMAPPER&quot;</span> <span class="hljs-attr">targetPackage</span>=<span class="hljs-string">&quot;example.mapper&quot;</span> <span class="hljs-attr">targetProject</span>=<span class="hljs-string">&quot;src/main/java&quot;</span>/&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">tableName</span>=<span class="hljs-string">&quot;FooTable&quot;</span> /&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">context</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">generatorConfiguration</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li>jdbcConnection:é…ç½®å¯¹åº”æ•°æ®åº“è¿æ¥ä¿¡æ¯;åŒ…æ‹¬æ•°æ®åº“é©±åŠ¨,è¿æ¥åœ°å€,ç”¨æˆ·å,å¯†ç .</li><li>javaModelGenerator:ç”Ÿæˆjavaæ¨¡å‹ç±»,é…ç½®åŒ…åå’Œæ¨¡å‹ç±»è·¯å¾„.</li><li>sqlMapGenerator:ç”Ÿæˆmapperæ˜ å°„,é…ç½®åŒ…å,å’Œæ˜ å°„æ–‡ä»¶è·¯å¾„.</li><li>table:ä»æ•°æ®åº“è¡¨ç”Ÿæˆå…·ä½“çš„æ¨¡å‹ç±»,é…ç½®æ•°æ®è¡¨åå’Œç”Ÿæˆjavaæ¨¡å‹ç±»ç±»å.</li></ul><p>3.è¿è¡Œé…ç½®</p><p>æ§åˆ¶å°è¾“å…¥<code>mvn mybatis-generator:generate</code>æˆ–è€…åœ¨ideaä¾§æ mavenæ’ä»¶ç‚¹å‡»mybatis-generatoræ’ä»¶:</p><p>æ˜¾ç¤º*<code>BUILD SUCCESS</code>*å³è¿è¡ŒæˆåŠŸå¹¶ç”Ÿæˆå¯¹åº”æ–‡ä»¶.</p>]]></content>
    
    
    
    <tags>
      
      <tag>-MyBatis -Spring</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Spring WebSocketå®ç°å‰åç«¯åˆ†ç¦»åœ¨çº¿èŠå¤©å®¤åº”ç”¨</title>
    <link href="/2024/11/07/Spring%20WebSocket%E5%AE%9E%E7%8E%B0%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E5%9C%A8%E7%BA%BF%E8%81%8A%E5%A4%A9%E5%AE%A4%E5%BA%94%E7%94%A8/"/>
    <url>/2024/11/07/Spring%20WebSocket%E5%AE%9E%E7%8E%B0%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E5%9C%A8%E7%BA%BF%E8%81%8A%E5%A4%A9%E5%AE%A4%E5%BA%94%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p>WebSocketæ˜¯ä¸€ç§åè®®ï¼Œç”¨äºåœ¨Webåº”ç”¨ç¨‹åºå’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹å®æ—¶ã€åŒå‘çš„é€šä¿¡è¿æ¥ã€‚å®ƒé€šè¿‡ä¸€ä¸ªå•ä¸€çš„TCPè¿æ¥æä¾›äº†æŒä¹…åŒ–è¿æ¥ï¼Œè¿™ä½¿å¾—Webåº”ç”¨ç¨‹åºå¯ä»¥æ›´åŠ å®æ—¶åœ°ä¼ é€’æ•°æ®ã€‚</p><h3 id="WebSocketçš„ä¼˜åŠ¿ï¼š"><a href="#WebSocketçš„ä¼˜åŠ¿ï¼š" class="headerlink" title="WebSocketçš„ä¼˜åŠ¿ï¼š"></a>WebSocketçš„ä¼˜åŠ¿ï¼š</h3><ul><li><strong>å®æ—¶æ€§å¼º</strong>ï¼šæ•°æ®å‡ ä¹å®æ—¶ä¼ è¾“ï¼Œæ— éœ€é¢‘ç¹è½®è¯¢ã€‚</li><li><strong>æ•ˆç‡é«˜</strong>ï¼šå‡å°‘äº†HTTPè¯·æ±‚çš„å¼€é”€ï¼ŒèŠ‚çœå¸¦å®½ã€‚</li><li><strong>å…¨åŒå·¥é€šä¿¡</strong>ï¼šæ”¯æŒåŒå‘æ•°æ®ä¼ è¾“ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å¯ä»¥éšæ—¶å‘é€æ¶ˆæ¯ã€‚</li></ul><h3 id="websocket-apiçš„javaå®ç°"><a href="#websocket-apiçš„javaå®ç°" class="headerlink" title="websocket-apiçš„javaå®ç°:"></a>websocket-apiçš„javaå®ç°:</h3><p>1.æ·»åŠ  WebSocket ç›¸å…³ä¾èµ–:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>javax.websocket<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>javax.websocket-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2.åˆ›å»ºä¸€ä¸ª Java ç±»æ¥å¤„ç† WebSocket è¿æ¥:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ServerEndpoint(&quot;/chat&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketServer</span> &#123;<br><br>    <span class="hljs-comment">//å½“å®¢æˆ·ç«¯å»ºç«‹è¿æ¥æ—¶è°ƒç”¨</span><br>    <span class="hljs-meta">@OnOpen</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onOpen</span><span class="hljs-params">(Session session)</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;é“¾æ¥æˆåŠŸ:&quot;</span>+session.getId());<br>    &#125;<br><br>    <span class="hljs-comment">//å½“å®¢æˆ·ç«¯æ”¶åˆ°æ¶ˆæ¯æ—¶è°ƒç”¨</span><br>    <span class="hljs-meta">@OnMessage</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">onMessage</span><span class="hljs-params">(String message,Session session)</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ¥æ”¶åˆ°æ¶ˆæ¯:&quot;</span>+session.getId());<br>        <span class="hljs-keyword">return</span> message;<br>    &#125;<br><br>    <span class="hljs-comment">//å½“å®¢æˆ·ç«¯å…³é—­è¿æ¥æ—¶è°ƒç”¨</span><br>    <span class="hljs-meta">@OnClose</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClose</span><span class="hljs-params">(Session session)</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å®¢æˆ·ç«¯å…³é—­è¿æ¥&quot;</span>+session.getId());<br>    &#125;<br><br>    <span class="hljs-comment">//å‘ç”Ÿå¼‚å¸¸æ—¶ä½¿ç”¨</span><br>    <span class="hljs-meta">@OnError</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onError</span><span class="hljs-params">(Session session,Throwable throwable)</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å‘é€é”™è¯¯&quot;</span>+throwable.getMessage());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>éƒ¨ç½²åˆ°æ”¯æŒwebsocketçš„å®¹å™¨ä¸­è¿è¡Œ(å¦‚tomcat).</p><p>3.åˆ›å»ºä¸€ä¸ªç®€å•çš„ HTML é¡µé¢æ¥è¿æ¥ WebSocket æœåŠ¡ç«¯ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>WebSocket Chat<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>WebSocket Chat<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;messages&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;messageInput&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;Type a message...&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;sendMessage()&quot;</span>&gt;</span>Send<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;chat.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">      <span class="hljs-keyword">let</span> socket = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">&#x27;ws://localhost:8080/chat&#x27;</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">socket.<span class="hljs-property">onopen</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Connected to the server&#x27;</span>);</span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"></span><br><span class="language-javascript">socket.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) &#123;</span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> messagesDiv = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;messages&#x27;</span>);</span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> message = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);</span><br><span class="language-javascript">    message.<span class="hljs-property">textContent</span> = event.<span class="hljs-property">data</span>;</span><br><span class="language-javascript">    messagesDiv.<span class="hljs-title function_">appendChild</span>(message);</span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"></span><br><span class="language-javascript">socket.<span class="hljs-property">onclose</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Disconnected from the server&#x27;</span>);</span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"></span><br><span class="language-javascript">socket.<span class="hljs-property">onerror</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) &#123;</span><br><span class="language-javascript">    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Error:&#x27;</span>, error);</span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">sendMessage</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> messageInput = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;messageInput&#x27;</span>);</span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> message = messageInput.<span class="hljs-property">value</span>;</span><br><span class="language-javascript">    <span class="hljs-keyword">if</span> (message) &#123;</span><br><span class="language-javascript">        socket.<span class="hljs-title function_">send</span>(message);</span><br><span class="language-javascript">        messageInput.<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;&#x27;</span>;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å½“ WebSocket è¿æ¥æˆåŠŸå»ºç«‹æ—¶ï¼Œå‰ç«¯é¡µé¢ä¼šå‘æœåŠ¡å™¨å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œå¹¶åœ¨æ”¶åˆ°æœåŠ¡å™¨çš„å“åº”æ—¶æ‰“å°å‡ºæ¶ˆæ¯å†…å®¹ã€‚</p><h3 id="ç”¨Spring-Bootç»“åˆwebsocket-APIå®ç°"><a href="#ç”¨Spring-Bootç»“åˆwebsocket-APIå®ç°" class="headerlink" title="ç”¨Spring Bootç»“åˆwebsocket APIå®ç°:"></a>ç”¨Spring Bootç»“åˆwebsocket APIå®ç°:</h3><p>1.æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š</p><ul><li>Spring Web</li><li>Spring WebSocket</li></ul><p>2.åˆ›å»ºä¸€ä¸ªwebsocketé…ç½®ç±»:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@EnableWebSocket</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebSocketConfigurer</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerWebSocketHandlers</span><span class="hljs-params">(WebSocketHandlerRegistry registry)</span> &#123;<br>        registry.addHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatHandler</span>(), <span class="hljs-string">&quot;/chat&quot;</span>).setAllowedOrigins(<span class="hljs-string">&quot;*&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>@Configurationï¼šè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼ŒSpring ä¼šæ‰«æå¹¶åŠ è½½è¿™ä¸ªç±»ä¸­çš„é…ç½®ã€‚<br>@EnableWebSocketï¼šå¯ç”¨ WebSocket æ”¯æŒã€‚<br>WebSocketConfigurerï¼šå®ç°äº† WebSocketConfigurer æ¥å£ï¼Œè¯¥æ¥å£æä¾›äº†é…ç½® WebSocket çš„æ–¹æ³•ã€‚<br>registerWebSocketHandlersï¼šé‡å†™äº† WebSocketConfigurer æ¥å£ä¸­çš„ registerWebSocketHandlers æ–¹æ³•ï¼Œç”¨äºæ³¨å†Œ WebSocket å¤„ç†å™¨ã€‚</p><p>è¿™æ®µä»£ç é…ç½®äº† WebSocket æ”¯æŒï¼Œå¹¶æ³¨å†Œäº†ä¸€ä¸ªå¤„ç† &#x2F;chat è·¯å¾„çš„ ChatHandlerï¼ŒåŒæ—¶å…è®¸æ‰€æœ‰æ¥æºçš„è·¨åŸŸè¯·æ±‚ã€‚</p><h4 id="3-å®ç°-WebSocket-Handler"><a href="#3-å®ç°-WebSocket-Handler" class="headerlink" title="3. å®ç° WebSocket Handler"></a>3. å®ç° WebSocket Handler</h4><p><code>ChatHandler</code> æ˜¯å¤„ç† WebSocket æ¶ˆæ¯çš„ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.web.socket.CloseStatus;<br><span class="hljs-keyword">import</span> org.springframework.web.socket.TextMessage;<br><span class="hljs-keyword">import</span> org.springframework.web.socket.WebSocketSession;<br><span class="hljs-keyword">import</span> org.springframework.web.socket.handler.TextWebSocketHandler;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">TextWebSocketHandler</span> &#123;<br>    <span class="hljs-comment">// ä¿å­˜æ‰€æœ‰ä¼šè¯</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;WebSocketSession&gt; sessions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(); <span class="hljs-comment">// ä½¿ç”¨ WebSocketSession è€Œé jakarta.websocket.Session</span><br><br>    <span class="hljs-comment">// ä¼šè¯å»ºç«‹åï¼Œå°†å½“å‰ä¼šè¯æ·»åŠ åˆ° sessions åˆ—è¡¨ä¸­</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterConnectionEstablished</span><span class="hljs-params">(WebSocketSession session)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        sessions.add(session);<br>    &#125;<br><br>    <span class="hljs-comment">// å°†æ”¶åˆ°çš„æ¶ˆæ¯å¹¿æ’­ç»™æ‰€æœ‰å®¢æˆ·ç«¯</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleTextMessage</span><span class="hljs-params">(WebSocketSession session, TextMessage message)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-keyword">for</span> (WebSocketSession webSocketSession : sessions) &#123;<br>            webSocketSession.sendMessage(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TextMessage</span>(message.getPayload()));<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// ä¼šè¯å…³é—­</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterConnectionClosed</span><span class="hljs-params">(WebSocketSession session, CloseStatus status)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        sessions.remove(session);<br>    &#125;<br></code></pre></td></tr></table></figure><p><code>ChatHandler</code> æ˜¯ä¸€ä¸ªç»§æ‰¿è‡ª <code>TextWebSocketHandler</code> çš„ç±»ï¼Œä¸“é—¨ç”¨äºå¤„ç† WebSocket è¿æ¥çš„æ¶ˆæ¯å’Œäº‹ä»¶ã€‚å®ƒè´Ÿè´£ç®¡ç†å®¢æˆ·ç«¯çš„è¿æ¥ã€æ¥æ”¶æ¶ˆæ¯ã€å¹¶å°†æ¶ˆæ¯å¹¿æ’­ç»™æ‰€æœ‰å·²è¿æ¥çš„å®¢æˆ·ç«¯ã€‚è¿™ä¸ªç±»å®ç°äº† WebSocket é€šä¿¡çš„åŸºç¡€åŠŸèƒ½ï¼Œå¦‚è¿æ¥ç®¡ç†ã€æ¶ˆæ¯å¤„ç†å’Œä¼šè¯å…³é—­å¤„ç†ã€‚</p><ul><li><h4 id="1-sessions-åˆ—è¡¨"><a href="#1-sessions-åˆ—è¡¨" class="headerlink" title="1. sessions åˆ—è¡¨"></a>1. <code>sessions</code> åˆ—è¡¨</h4><ul><li><strong>æè¿°</strong>ï¼šè¿™æ˜¯ä¸€ä¸ª <code>List&lt;WebSocketSession&gt;</code>ï¼Œç”¨äºä¿å­˜æ‰€æœ‰å½“å‰æ´»åŠ¨çš„ WebSocket ä¼šè¯ã€‚æ¯å½“å®¢æˆ·ç«¯å»ºç«‹ WebSocket è¿æ¥æ—¶ï¼Œå½“å‰ä¼šè¯å°†è¢«æ·»åŠ åˆ°è¿™ä¸ªåˆ—è¡¨ä¸­ï¼Œå½“å®¢æˆ·ç«¯æ–­å¼€è¿æ¥æ—¶ï¼Œä¼šä»è¿™ä¸ªåˆ—è¡¨ä¸­ç§»é™¤ã€‚å®ƒç¡®ä¿æ¶ˆæ¯èƒ½å¤Ÿè¢«å¹¿æ’­åˆ°æ‰€æœ‰è¿æ¥ä¸­çš„å®¢æˆ·ç«¯ã€‚</li></ul><h4 id="2-afterConnectionEstablished-WebSocketSession-session"><a href="#2-afterConnectionEstablished-WebSocketSession-session" class="headerlink" title="2. afterConnectionEstablished(WebSocketSession session)"></a>2. <code>afterConnectionEstablished(WebSocketSession session)</code></h4><ul><li><strong>æè¿°</strong>ï¼šå½“ WebSocket è¿æ¥å»ºç«‹æ—¶è°ƒç”¨æ­¤æ–¹æ³•ã€‚æ­¤æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå°†æ–°è¿æ¥çš„å®¢æˆ·ç«¯ä¼šè¯å¯¹è±¡ <code>session</code> æ·»åŠ åˆ° <code>sessions</code> åˆ—è¡¨ä¸­ã€‚ç®¡ç†æ–°è¿æ¥çš„å®¢æˆ·ç«¯ä¼šè¯ï¼Œå…è®¸åç»­å¯¹æ‰€æœ‰å·²è¿æ¥å®¢æˆ·ç«¯çš„æ¶ˆæ¯è¿›è¡Œå¹¿æ’­ã€‚</li></ul><h4 id="3-handleTextMessage-WebSocketSession-session-TextMessage-message"><a href="#3-handleTextMessage-WebSocketSession-session-TextMessage-message" class="headerlink" title="3. handleTextMessage(WebSocketSession session, TextMessage message)"></a>3. <code>handleTextMessage(WebSocketSession session, TextMessage message)</code></h4><ul><li><p><strong>æè¿°</strong>ï¼šå½“æœåŠ¡å™¨æ”¶åˆ°æŸä¸ªå®¢æˆ·ç«¯å‘é€çš„æ–‡æœ¬æ¶ˆæ¯æ—¶è§¦å‘è¯¥æ–¹æ³•ã€‚æ–¹æ³•å‚æ•°ä¸­åŒ…å«äº†å‘é€æ¶ˆæ¯çš„ä¼šè¯ <code>session</code> å’Œæ¶ˆæ¯å†…å®¹ <code>message</code>ã€‚</p><p>æœåŠ¡å™¨ä¼šéå† <code>sessions</code> åˆ—è¡¨ï¼Œå¹¶å°†æ¥æ”¶åˆ°çš„æ¶ˆæ¯å¹¿æ’­ç»™æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯ã€‚æ­¤åŠŸèƒ½ä½¿æ‰€æœ‰å®¢æˆ·ç«¯èƒ½å¤Ÿå®æ—¶æ¥æ”¶åˆ°å…¶å®ƒå®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯ã€‚</p></li></ul><h4 id="4-afterConnectionClosed-WebSocketSession-session-CloseStatus-status"><a href="#4-afterConnectionClosed-WebSocketSession-session-CloseStatus-status" class="headerlink" title="4. afterConnectionClosed(WebSocketSession session, CloseStatus status)"></a>4. <code>afterConnectionClosed(WebSocketSession session, CloseStatus status)</code></h4><ul><li><strong>æè¿°</strong>ï¼šå½“ WebSocket è¿æ¥å…³é—­æ—¶è°ƒç”¨æ­¤æ–¹æ³•ã€‚æ­¤æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå°†å…³é—­çš„å®¢æˆ·ç«¯ä¼šè¯å¯¹è±¡ <code>session</code> ä» <code>sessions</code> åˆ—è¡¨ä¸­ç§»é™¤ã€‚æ¸…ç†å·²ç»æ–­å¼€çš„å®¢æˆ·ç«¯è¿æ¥ï¼Œç¡®ä¿ <code>sessions</code> åˆ—è¡¨ä¸­åªåŒ…å«å½“å‰æ´»è·ƒçš„ WebSocket ä¼šè¯ã€‚</li></ul></li></ul><p>4.åˆ›å»ºä¸€ä¸ªç®€å•çš„vueé¡µé¢</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>åœ¨çº¿èŠå¤©<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;chat-window&quot;</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;msg in messages&quot;</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;msg&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;message&quot;</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">msg</span> &#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;inputMessage&quot;</span> @<span class="hljs-attr">keyup.enter</span>=<span class="hljs-string">&quot;sendMessage&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;è¾“å…¥æ¶ˆæ¯...&quot;</span> /&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-attr">socket</span>: <span class="hljs-literal">null</span>,</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-attr">inputMessage</span>: <span class="hljs-string">&#x27;&#x27;</span>,</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-attr">messages</span>: []</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;;</span></span><br><span class="language-javascript"><span class="language-xml">  &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">connectWebSocket</span>();</span></span><br><span class="language-javascript"><span class="language-xml">  &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-attr">methods</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">connectWebSocket</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-variable language_">this</span>.<span class="hljs-property">socket</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">&quot;ws://localhost:8080/chat&quot;</span>);</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-variable language_">this</span>.<span class="hljs-property">socket</span>.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span>.<span class="hljs-title function_">push</span>(event.<span class="hljs-property">data</span>);</span></span><br><span class="language-javascript"><span class="language-xml">      &#125;;</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">sendMessage</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">inputMessage</span>.<span class="hljs-title function_">trim</span>() !== <span class="hljs-string">&#x27;&#x27;</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">socket</span>.<span class="hljs-title function_">send</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">inputMessage</span>);</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputMessage</span> = <span class="hljs-string">&#x27;&#x27;</span>;</span></span><br><span class="language-javascript"><span class="language-xml">      &#125;</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;</span></span><br><span class="language-javascript"><span class="language-xml">  &#125;</span></span><br><span class="language-javascript"><span class="language-xml">&#125;;</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.chat-window</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ccc</span>;</span></span><br><span class="language-css"><span class="language-xml">  <span class="hljs-attribute">height</span>: <span class="hljs-number">300px</span>;</span></span><br><span class="language-css"><span class="language-xml">  <span class="hljs-attribute">overflow-y</span>: auto;</span></span><br><span class="language-css"><span class="language-xml">  <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;</span></span><br><span class="language-css"><span class="language-xml">  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">10px</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.message</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">5px</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br><span class="language-xml"></span><br></code></pre></td></tr></table></figure><p>è®¿é—®é¡µé¢å¯ä»¥çœ‹åˆ°:</p><p><img src="/images/01.png" alt="å›¾ç‰‡"></p><p>è¯•ç€åœ¨å¦ä¸€ä¸ªçª—å£å‘é€æ¶ˆæ¯;</p><p><img src="/images/02.png" alt="å›¾ç‰‡"></p><p>å¯ä»¥æ˜¾ç¤ºå¯¹åº”æ¶ˆæ¯.</p><p>æœ¬æ–‡åç«¯åŸºäºSpring WebSocketå®ç°äº†ç®€å•çš„å‰åç«¯åˆ†ç¦»åœ¨çº¿èŠå¤©å®¤åº”ç”¨,å½“ç„¶è¿™åªæ˜¯ä¸€ä¸ªåŸºç¡€çš„åº”ç”¨,è·ç¦»å®Œæ•´è¿˜æœ‰è·ç¦»,å¸Œæœ›ä»¥åæœ‰æœºä¼šå®Œå–„.</p>]]></content>
    
    
    
    <tags>
      
      <tag>Spring</tag>
      
      <tag>Vue</tag>
      
      <tag>Websocket</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Spring boot+Vueå®ç°ç®€å•åœ¨çº¿ä¸ªäººåšå®¢</title>
    <link href="/2024/11/01/Spring%20boot+Vue%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E5%9C%A8%E7%BA%BF%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    <url>/2024/11/01/Spring%20boot+Vue%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E5%9C%A8%E7%BA%BF%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸ºSpringå­¦ä¹ é¡¹ç›®ä¹‹ä¸€:</p><p>1.å¼•å…¥ä¾èµ–,åˆ›å»ºVueé¡¹ç›®</p><p>2.åˆ›å»ºæ•°æ®åº“</p><p>3.åˆ›å»ºå®ä½“ç±»å’ŒJPAæ¥å£</p><p>4.åˆ›å»ºæœåŠ¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PostService</span> &#123;<br>    <span class="hljs-meta">@Autowired</span> <span class="hljs-keyword">private</span> PostRepository postRepository;<br><br>    <span class="hljs-comment">//æŸ¥è¯¢æ‰€æœ‰blog</span><br>    <span class="hljs-keyword">public</span> List&lt;Post&gt; <span class="hljs-title function_">findAll</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> postRepository.findAll();<br>    &#125;<br><br>    <span class="hljs-comment">//æ ¹æ®idæŸ¥æ‰¾blog</span><br>    <span class="hljs-keyword">public</span> Optional&lt;Post&gt; <span class="hljs-title function_">findById</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span>&#123;<br>        <span class="hljs-keyword">return</span> postRepository.findById(id);<br>    &#125;<br><br>    <span class="hljs-comment">//ä¿å­˜blog</span><br>    <span class="hljs-keyword">public</span> Post <span class="hljs-title function_">save</span><span class="hljs-params">(Post post)</span>&#123;<br>        <span class="hljs-keyword">return</span> postRepository.save(post);<br>    &#125;<br><br>    <span class="hljs-comment">//åˆ é™¤blog</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteById</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span>&#123;<br>        postRepository.deleteById(id);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>5.åˆ›å»ºController</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/api/posts&quot;)</span><br><span class="hljs-meta">@CrossOrigin(origins = &quot;http://localhost:5173/&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PostController</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> PostService postService;<br><br>    <span class="hljs-comment">// è·å–æ‰€æœ‰æ–‡ç« </span><br>    <span class="hljs-meta">@GetMapping(&quot;/all&quot;)</span><br>    <span class="hljs-keyword">public</span> List&lt;Post&gt; <span class="hljs-title function_">getAllPosts</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> postService.findAll();<br>    &#125;<br><br>    <span class="hljs-comment">// æ ¹æ®IDè·å–æ–‡ç« </span><br>    <span class="hljs-meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span><br>    <span class="hljs-keyword">public</span> ResponseEntity&lt;Post&gt; <span class="hljs-title function_">getPostById</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> <span class="hljs-type">int</span> id)</span> &#123;<br>        Optional&lt;Post&gt; post = postService.findById(id);<br>        <span class="hljs-keyword">return</span> post.map(ResponseEntity::ok)<br>                .orElseGet(() -&gt; ResponseEntity.notFound().build());<br>    &#125;<br><br>    <span class="hljs-comment">// åˆ›å»ºæ–°æ–‡ç« </span><br>    <span class="hljs-meta">@PostMapping</span><br>    <span class="hljs-keyword">public</span> Post <span class="hljs-title function_">createPost</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> Post post)</span> &#123;<br>        post.setCreatedAt(java.time.LocalDateTime.now());<br>        <span class="hljs-keyword">return</span> postService.save(post);<br>    &#125;<br><br>    <span class="hljs-comment">// æ›´æ–°ç°æœ‰æ–‡ç« </span><br>    <span class="hljs-meta">@PutMapping(&quot;/&#123;id&#125;&quot;)</span><br>    <span class="hljs-keyword">public</span> ResponseEntity&lt;Post&gt; <span class="hljs-title function_">updatePost</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> <span class="hljs-type">int</span> id, <span class="hljs-meta">@RequestBody</span> Post postDetails)</span> &#123;<br>        Optional&lt;Post&gt; optionalPost = postService.findById(id);<br>        <span class="hljs-keyword">if</span> (optionalPost.isPresent()) &#123;<br>            <span class="hljs-type">Post</span> <span class="hljs-variable">post</span> <span class="hljs-operator">=</span> optionalPost.get();<br>            post.setTitle(postDetails.getTitle());<br>            post.setContent(postDetails.getContent());<br>            <span class="hljs-type">Post</span> <span class="hljs-variable">updatedPost</span> <span class="hljs-operator">=</span> postService.save(post);<br>            <span class="hljs-keyword">return</span> ResponseEntity.ok(updatedPost);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> ResponseEntity.notFound().build();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// åˆ é™¤æ–‡ç« </span><br>    <span class="hljs-meta">@DeleteMapping(&quot;/&#123;id&#125;&quot;)</span><br>    <span class="hljs-keyword">public</span> ResponseEntity&lt;Void&gt; <span class="hljs-title function_">deletePost</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> <span class="hljs-type">int</span> id)</span> &#123;<br>        Optional&lt;Post&gt; post = postService.findById(id);<br>        <span class="hljs-keyword">if</span> (post.isPresent()) &#123;<br>            postService.deleteById(id);<br>            <span class="hljs-keyword">return</span> ResponseEntity.noContent().build();<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> ResponseEntity.notFound().build();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>6.å‰ç«¯é¡µé¢:</p><p>(1)åšå®¢ä¸»é¡µ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;h1&gt;æˆ‘çš„åšå®¢&lt;/h1&gt;<br>  &lt;router-link to=&quot;/create&quot;&gt;åˆ›å»ºæ–°æ–‡ç« &lt;/router-link&gt;<br>  &lt;ul&gt;<br>    &lt;li v-for=&quot;post in posts&quot; :key=&quot;post.id&quot;&gt;<br>        &lt;router-link :to=&quot;`/posts/$&#123;post.id&#125;`&quot;&gt;&#123;&#123; post.title &#125;&#125;&lt;/router-link&gt;<br>    &lt;/li&gt;<br>  &lt;/ul&gt;<br>&lt;/template&gt;<br><br>&lt;script&gt;<br>import axios from &#x27;axios&#x27;;<br><br>export default &#123;<br>    data() &#123;<br>        return &#123;<br>            posts: [],<br>        &#125;;<br>    &#125;,<br>    created() &#123;<br>        axios.get(&#x27;http://localhost:8080/api/posts/all&#x27;).then(response =&gt; &#123;<br>            this.posts = response.data;<br>        &#125;);<br>    &#125;,<br>&#125;;<br>&lt;/script&gt;<br><br>&lt;style&gt;<br><br>&lt;/style&gt;<br><br></code></pre></td></tr></table></figure><p>(2)åˆ›å»ºåšå®¢é¡µé¢:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt; <br>    &lt;div&gt; <br>      &lt;h1&gt;åˆ›å»ºæ–°æ–‡ç« &lt;/h1&gt; <br>      &lt;form @submit.prevent=&quot;createPost&quot;&gt; <br>        &lt;div&gt; <br>          &lt;label for=&quot;title&quot;&gt;æ ‡é¢˜ï¼š&lt;/label&gt; <br>          &lt;input type=&quot;text&quot; v-model=&quot;post.title&quot; required /&gt;<br>        &lt;/div&gt;<br>        &lt;div&gt;<br>          &lt;label for=&quot;content&quot;&gt;å†…å®¹ï¼š&lt;/label&gt;<br>          &lt;textarea v-model=&quot;post.content&quot; required&gt;&lt;/textarea&gt;<br>        &lt;/div&gt;<br>        &lt;button type=&quot;submit&quot;&gt;å‘å¸ƒ&lt;/button&gt;<br>      &lt;/form&gt; <br>    &lt;/div&gt; <br>  &lt;/template&gt; <br>  <br>  &lt;script&gt;<br>  import axios from &#x27;axios&#x27;;<br>  <br>  export default &#123;<br>    data() &#123;<br>      return &#123;<br>        post: &#123;<br>          title: &#x27;&#x27;,<br>          content: &#x27;&#x27;,<br>        &#125;,<br>      &#125;;<br>    &#125;,<br>    methods: &#123; <br>      createPost() &#123; <br>        console.log(this.post); // æ£€æŸ¥ post æ˜¯å¦å®šä¹‰ <br>        axios.post(&#x27;http://localhost:8080/api/posts&#x27;, this.post)<br>          .then(() =&gt; &#123;<br>            this.$router.push(&#x27;/&#x27;);<br>          &#125;)<br>          .catch(error =&gt; &#123; <br>            console.error(&quot;å‘å¸ƒæ–‡ç« å¤±è´¥:&quot;, error); <br>          &#125;); <br>      &#125;, <br>    &#125;, <br>  &#125;<br>  &lt;/script&gt;<br>  <br></code></pre></td></tr></table></figure><p>(3)åšå®¢è¯¦æƒ…é¡µé¢:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>      &lt;h1&gt;&#123;&#123; post.title &#125;&#125;&lt;/h1&gt;<br>      &lt;p&gt;&#123;&#123; post.content &#125;&#125;&lt;/p&gt;<br>      &lt;router-link to=&quot;/&quot;&gt;è¿”å›é¦–é¡µ&lt;/router-link&gt;<br>    &lt;/div&gt;<br>  &lt;/template&gt;<br>  <br>  &lt;script&gt;<br><br>import axios from &quot;axios&quot;;<br><br>  export default &#123;<br>    data() &#123;<br>      return &#123;<br>        post: &#123;&#125;,<br>      &#125;;<br>    &#125;,<br>    created() &#123;<br>      const id = this.$route.params.id;<br>      axios.get(`http://localhost:8080/api/posts/$&#123;id&#125;`)<br>        .then(response =&gt; &#123;<br>          this.post = response.data;<br>        &#125;)<br>        .catch(error =&gt; &#123;<br>          console.error(&quot;è·å–æ–‡ç« è¯¦æƒ…å¤±è´¥:&quot;, error);<br>        &#125;);<br>    &#125;,<br>  &#125;;<br>  &lt;/script&gt;<br>  <br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>Spring</tag>
      
      <tag>Vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Spring boot+Mybatiså®ç°å‰åç«¯åˆ†ç¦»CRUDæ“ä½œ</title>
    <link href="/2024/10/28/Spring-boot+Mybatis%E5%AE%9E%E7%8E%B0%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BBCRUD%E6%93%8D%E4%BD%9C/"/>
    <url>/2024/10/28/Spring-boot+Mybatis%E5%AE%9E%E7%8E%B0%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BBCRUD%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<p>æŒä¹…å±‚æ¡†æ¶ä¸ªäººæ›´å€¾å‘äºä½¿ç”¨JPA,ä½†è€ƒè™‘åˆ°Mybatiså›½å†…ä½¿ç”¨çš„å¹¿æ³›æ€§,ä»¥æ­¤ç¯‡æ–‡ç« è®°å½•Spring boot+Mybatiså®ç°å‰åç«¯åˆ†ç¦»CRUDæ“ä½œçš„å­¦ä¹ è¿‡ç¨‹,æ—¨åœ¨ç†Ÿæ‚‰MybatisæŒä¹…å±‚çš„ä½¿ç”¨.</p><p>1.å¼•å…¥ç›¸å…³ä¾èµ–</p><ul><li>Spring Web</li><li>MyBatis Framework</li><li>MySQL Driver</li><li>Lombok (å¯é€‰)</li></ul><p>2.é…ç½® application.properties<br>åœ¨ src&#x2F;main&#x2F;resources ç›®å½•ä¸‹åˆ›å»ºæˆ–ç¼–è¾‘ application.properties æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">spring.datasource.url</span>=<span class="hljs-string">jdbc:mysql://localhost:3306/your_database?useSSL=false&amp;serverTimezone=UTC</span><br><span class="hljs-attr">spring.datasource.username</span>=<span class="hljs-string">your_username</span><br><span class="hljs-attr">spring.datasource.password</span>=<span class="hljs-string">your_password</span><br><span class="hljs-attr">spring.datasource.driver-class-name</span>=<span class="hljs-string">com.mysql.cj.jdbc.Driver</span><br><br><span class="hljs-attr">mybatis.mapper-locations</span>=<span class="hljs-string">classpath:mapper/*.xml</span><br></code></pre></td></tr></table></figure><p>3.åˆ›å»ºUserå®ä½“ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> id;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Date birthday;<br>    <span class="hljs-keyword">private</span> String address;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> verified;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> phone;<br>&#125;<br></code></pre></td></tr></table></figure><p>4.åˆ›å»ºUserMapperæ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserMapper</span> &#123;<br>    <span class="hljs-comment">//æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·</span><br>    <span class="hljs-meta">@Select(&quot;select * from users&quot;)</span><br>    List&lt;User&gt; <span class="hljs-title function_">findAll</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-comment">//æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·</span><br>    <span class="hljs-meta">@Select(&quot;select * from users where id = #&#123;id&#125;&quot;)</span><br>    User <span class="hljs-title function_">findById</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span>;<br><br>    <span class="hljs-comment">//æ·»åŠ ç”¨æˆ·</span><br>    <span class="hljs-meta">@Insert(&quot;insert into users (id, name, birthday, address, verified, phone) VALUES (#&#123;id&#125;,#&#123;name&#125;,#&#123;birthday&#125;,#&#123;address&#125;,#&#123;verified&#125;,#&#123;phone&#125;)&quot;)</span><br>    <span class="hljs-meta">@Options(useGeneratedKeys = true,keyProperty = &quot;id&quot;)</span><br>    <span class="hljs-type">int</span> <span class="hljs-title function_">insertUser</span><span class="hljs-params">(User user)</span>;<br><br>    <span class="hljs-comment">//æ›´æ–°ç”¨æˆ·</span><br>    <span class="hljs-meta">@Update(&quot;update users set name = #&#123;name&#125;,birthday = #&#123;birthday&#125;,address = #&#123;address&#125;,verified = #&#123;vierfied&#125;,phone = #&#123;phone&#125; where id = #&#123;id&#125; &quot;)</span><br>    <span class="hljs-type">int</span> <span class="hljs-title function_">updateUser</span><span class="hljs-params">(User user)</span>;<br><br>    <span class="hljs-comment">//åˆ é™¤ç”¨æˆ·</span><br>    <span class="hljs-meta">@Delete(&quot;delete from users where id = #&#123;id&#125;&quot;)</span><br>    <span class="hljs-type">int</span> <span class="hljs-title function_">deleteUser</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>5.åˆ›å»ºServiceå±‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> UserMapper userMapper;<br><br>    <span class="hljs-comment">//æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·</span><br>    <span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">findAll</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> userMapper.findAll();<br>    &#125;<br><br>    <span class="hljs-comment">//æ ¹æ®IDæŸ¥è¯¢</span><br>    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">findById</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span>&#123;<br>        <span class="hljs-keyword">return</span> userMapper.findById(id);<br>    &#125;<br><br>    <span class="hljs-comment">//æ·»åŠ ç”¨æˆ·</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">insertUser</span><span class="hljs-params">(User user)</span>&#123;<br>        <span class="hljs-keyword">return</span> userMapper.insertUser(user);<br>    &#125;<br><br>    <span class="hljs-comment">//æ›´æ–°ç”¨æˆ·</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">updateUser</span><span class="hljs-params">(User user)</span>&#123;<br>        <span class="hljs-keyword">return</span> userMapper.updateUser(user);<br>    &#125;<br><br>    <span class="hljs-comment">//åˆ é™¤ç”¨æˆ·</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">deleteUser</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span>&#123;<br>        <span class="hljs-keyword">return</span> userMapper.deleteUser(id);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>6.åˆ›å»ºControllerå±‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@CrossOrigin(origins = &quot;http://localhost:5173/&quot;)</span><br><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/api/users&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> UserService userService;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/all&quot;)</span><br>    <span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">findAll</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> userService.findAll();<br>    &#125;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span><br>    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">findById</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> <span class="hljs-type">int</span> id)</span>&#123;<br>        <span class="hljs-keyword">return</span> userService.findById(id);<br>    &#125;<br><br>    <span class="hljs-meta">@PostMapping(&quot;/insert&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> User user)</span>&#123;<br>        <span class="hljs-keyword">return</span> userService.insertUser(user);<br>    &#125;<br><br>    <span class="hljs-meta">@PutMapping(&quot;/update&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> User user)</span>&#123;<br>        <span class="hljs-keyword">return</span> userService.updateUser(user);<br>    &#125;<br><br>    <span class="hljs-meta">@DeleteMapping(&quot;/delete/&#123;id&#125;&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> <span class="hljs-type">int</span> id)</span>&#123;<br>        <span class="hljs-keyword">return</span> userService.deleteUser(id);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>7.åˆ›å»º MyBatis XML æ˜ å°„æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;cn.scitc.com.springmybatisapi.mapper.UserMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;findAll&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;cn.scitc.com.springmybatisapi.entity.User&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;selectAllColumns&quot;</span>/&gt;</span><br>        FROM user<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;findById&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;long&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;cn.scitc.com.springmybatisapi.entity.User&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;selectAllColumns&quot;</span>/&gt;</span><br>        FROM user WHERE id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;insert&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;cn.scitc.com.springmybatisapi.entity.User&quot;</span> <span class="hljs-attr">useGeneratedKeys</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">keyProperty</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span><br>        INSERT INTO user(name, email, birthday, address, gender) VALUES(#&#123;name&#125;, #&#123;email&#125;, #&#123;birthday&#125;, #&#123;address&#125;, #&#123;gender&#125;)<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;update&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;cn.scitc.com.springmybatisapi.entity.User&quot;</span>&gt;</span><br>        UPDATE user SET name = #&#123;name&#125;, email = #&#123;email&#125;, birthday = #&#123;birthday&#125;, address = #&#123;address&#125;, gender = #&#123;gender&#125; WHERE id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">delete</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;deleteById&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;long&quot;</span>&gt;</span><br>        DELETE FROM user WHERE id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">delete</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">sql</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectAllColumns&quot;</span>&gt;</span><br>        SELECT id, name, email, birthday, address, gender<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">sql</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure><p>8.å®Œæˆå‰ç«¯é¡µé¢</p><template>  <h1>ç”¨æˆ·ç®¡ç†</h1>  <div class="users">    <ul>      <li v-for="user in users" :key="user.id">        <div v-if="!user.isEditing">          {{ user.name }} {{ user.age }}å² {{ user.address }} {{ user.phone }} {{ user.verified ? 'å·²éªŒè¯' : 'æœªéªŒè¯' }}          <button @click="edit(user)">ç¼–è¾‘</button>          <button @click="edit(user)">ç¼–è¾‘</button>          <button @click="deleteUser(user.id)">åˆ é™¤</button>        </div>        <div v-else>          <input v-model="user.name" />          <input type="date" v-model="user.birthday" @change="calculateAge(user)" /> <!-- ä½¿ç”¨æ—¥æœŸè¾“å…¥ -->          <input v-model="user.address" />          <input v-model="user.phone" />          <input type="checkbox" v-model="user.verified" /> å·²éªŒè¯          <button @click="updateUser(user)">ä¿å­˜</button>          <button @click="cancelEdit(user)">å–æ¶ˆ</button>        </div>      </li>    </ul>    <form @submit.prevent="addUser">      <input type="text" placeholder="å§“å" v-model="newUser.name" required>      <input type="date" v-model="newUser.birthday" @change="calculateAge(newUser)" required /> <!-- ä½¿ç”¨æ—¥æœŸè¾“å…¥ -->      <input type="text" placeholder="åœ°å€" v-model="newUser.address" required>      <input type="text" placeholder="æ‰‹æœºå·" v-model="newUser.phone" required>      <input type="checkbox" v-model="newUser.verified" /> æ˜¯å¦å·²éªŒè¯      <button type="submit">æ·»åŠ </button>    </form>  </div></template><script>import axios from 'axios'```javascriptexport default {  data() {    return {      users: [],      newUser: {        name: '',        birthday: '', // æ”¹ä¸ºbirthday        age: '',        address: '',        phone: '',        verified: false      }    }  },  methods: {    fetchUsers() {      axios.get("http://localhost:8080/api/users/all")        .then(response => {          this.users = response.data.map(user => {            user.age = this.calculateAgeFromBirthday(user.birthday); // æ·»åŠ ageè®¡ç®—            return { ...user, isEditing: false };          });        })        .catch(error => {          console.error('è·å–ç”¨æˆ·æ•°æ®å¤±è´¥', error);        });    },    addUser() {      axios.post("http://localhost:8080/api/users/insert", this.newUser)        .then(response => {          response.data.age = this.calculateAgeFromBirthday(response.data.birthday); // è®¡ç®—æ–°ç”¨æˆ·çš„å¹´é¾„          this.users.push({ ...response.data, isEditing: false });          this.resetNewUser();        })        .catch(error => {          console.error('æ·»åŠ ç”¨æˆ·å¤±è´¥', error);        });    },    edit(user) {      user.isEditing = true; // è¿›å…¥ç¼–è¾‘æ¨¡å¼    },    updateUser(user) {      axios.put(`http://localhost:8080/api/users/update/${user.id}`, user)        .then(response => {          user.isEditing = false; // é€€å‡ºç¼–è¾‘æ¨¡å¼          Object.assign(user, response.data); // æ›´æ–°ç”¨æˆ·ä¿¡æ¯          user.age = this.calculateAgeFromBirthday(user.birthday); // æ›´æ–°å¹´é¾„        })        .catch(error => {          console.error('æ›´æ–°ç”¨æˆ·å¤±è´¥', error);        });    },    cancelEdit(user) {      user.isEditing = false; // å–æ¶ˆç¼–è¾‘    },    deleteUser(userId) {      axios.delete(`http://localhost:8080/api/users/delete/${userId}`)        .then(response => {          this.users = this.users.filter(user => user.id !== userId);        })        .catch(error => {          console.error('åˆ é™¤ç”¨æˆ·å¤±è´¥', error);        });    },    resetNewUser() {      this.newUser = {        name: '',        birthday: '',        age: '',        address: '',        phone: '',        verified: false      };    },    calculateAgeFromBirthday(birthday) {      const birthDate = new Date(birthday);      const ageDiff = Date.now() - birthDate.getTime();      const ageDate = new Date(ageDiff);      return Math.abs(ageDate.getUTCFullYear() - 1970); // è¿”å›å¹´é¾„    },    calculateAge(user) {      user.age = this.calculateAgeFromBirthday(user.birthday);    }  },  mounted() {    this.fetchUsers();  }}</scrip>]]></content>
    
    
    
    <tags>
      
      <tag>Spring</tag>
      
      <tag>java</tag>
      
      <tag>Mybatis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>FFmpeg æ•™ç¨‹ï¼ˆWindows ç‰ˆï¼‰</title>
    <link href="/2024/10/27/FFmpeg-%E6%95%99%E7%A8%8B%EF%BC%88Windows-%E7%89%88%EF%BC%89/"/>
    <url>/2024/10/27/FFmpeg-%E6%95%99%E7%A8%8B%EF%BC%88Windows-%E7%89%88%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="FFmpeg-æ•™ç¨‹ï¼ˆWindows-ç‰ˆï¼‰"><a href="#FFmpeg-æ•™ç¨‹ï¼ˆWindows-ç‰ˆï¼‰" class="headerlink" title="FFmpeg æ•™ç¨‹ï¼ˆWindows ç‰ˆï¼‰"></a>FFmpeg æ•™ç¨‹ï¼ˆWindows ç‰ˆï¼‰</h1><p>FFmpeg æ˜¯ä¸€ä¸ªå¼€æºçš„å¤šåª’ä½“æ¡†æ¶ï¼Œç”¨äºå¤„ç†éŸ³è§†é¢‘æ–‡ä»¶ï¼ŒåŒ…æ‹¬è½¬ç ã€å‰ªè¾‘ã€åˆå¹¶ã€åˆ†å‰²ç­‰åŠŸèƒ½ã€‚æœ¬æ–‡å°†ä¸ºæ‚¨ä»‹ç»å¦‚ä½•åœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šå®‰è£…å’Œä½¿ç”¨ FFmpegã€‚</p><hr><h2 id="FFmpeg-ç®€ä»‹"><a href="#FFmpeg-ç®€ä»‹" class="headerlink" title="FFmpeg ç®€ä»‹"></a>FFmpeg ç®€ä»‹</h2><p>FFmpeg æ˜¯ä¸€ä¸ªå…è´¹çš„å¼€æºé¡¹ç›®ï¼ŒåŒ…å«äº†ä¸€å¥—ç”¨äºå¤„ç†éŸ³è§†é¢‘æ•°æ®çš„å·¥å…·å’Œåº“ã€‚å®ƒæ”¯æŒå‡ ä¹æ‰€æœ‰å·²çŸ¥çš„éŸ³è§†é¢‘æ ¼å¼ï¼Œå¹¶ä¸”å¯ä»¥æ‰§è¡Œå¤šç§å¤æ‚çš„æ“ä½œï¼Œå¦‚è½¬ç ã€è½¬å°è£…ã€æµåª’ä½“å¤„ç†ç­‰ã€‚ç”±äºå…¶å¼ºå¤§çš„åŠŸèƒ½å’Œçµæ´»æ€§ï¼ŒFFmpeg è¢«å¹¿æ³›åº”ç”¨äºå„ç§å¤šåª’ä½“é¡¹ç›®ä¸­ã€‚</p><h2 id="ä¸‹è½½-FFmpeg"><a href="#ä¸‹è½½-FFmpeg" class="headerlink" title="ä¸‹è½½ FFmpeg"></a>ä¸‹è½½ FFmpeg</h2><ol><li><strong>è®¿é—®å®˜æ–¹ç½‘ç«™</strong>ï¼šå‰å¾€ FFmpeg çš„å®˜æ–¹ç½‘ç«™ <a href="https://ffmpeg.org/download.html%E3%80%82">https://ffmpeg.org/download.htmlã€‚</a></li><li><strong>é€‰æ‹© Windows ç‰ˆæœ¬</strong>ï¼šåœ¨â€œGet packages &amp; executable filesâ€éƒ¨åˆ†ï¼Œç‚¹å‡» Windows çš„å›¾æ ‡ï¼Œè¿›å…¥ Windows ç‰ˆæœ¬çš„ä¸‹è½½é¡µé¢ã€‚</li><li><strong>é€‰æ‹©é¢„ç¼–è¯‘ç‰ˆæœ¬</strong>ï¼šæ¨èä½¿ç”¨ Gyan.dev æˆ– <a href="https://github.com/BtbN/FFmpeg-Builds/releases">BtbN</a> æä¾›çš„é¢„ç¼–è¯‘ç‰ˆæœ¬ã€‚</li><li><strong>ä¸‹è½½å‹ç¼©åŒ…</strong>ï¼šé€‰æ‹©é€‚åˆæ‚¨ç³»ç»Ÿçš„ç‰ˆæœ¬ï¼ˆé€šå¸¸ä¸º <code>ffmpeg-release-essentials.zip</code> æˆ–ç±»ä¼¼åç§°çš„æ–‡ä»¶ï¼‰ï¼Œç‚¹å‡»ä¸‹è½½ã€‚</li></ol><h2 id="å®‰è£…-FFmpeg"><a href="#å®‰è£…-FFmpeg" class="headerlink" title="å®‰è£… FFmpeg"></a>å®‰è£… FFmpeg</h2><ol><li><p><strong>è§£å‹å‹ç¼©åŒ…</strong>ï¼šå°†ä¸‹è½½çš„å‹ç¼©åŒ…è§£å‹åˆ°æ‚¨å¸Œæœ›å®‰è£… FFmpeg çš„ç›®å½•ï¼Œä¾‹å¦‚ <code>C:\ffmpeg</code>ã€‚</p></li><li><p><strong>æ–‡ä»¶ç»“æ„</strong>ï¼šè§£å‹åï¼Œæ‚¨åº”è¯¥çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„æ–‡ä»¶å¤¹ç»“æ„ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs stylus">makefileå¤åˆ¶ä»£ç C:\ffmpeg<br>â”œâ”€â”€ bin<br>â”‚   â”œâ”€â”€ ffmpeg<span class="hljs-selector-class">.exe</span><br>â”‚   â”œâ”€â”€ ffplay<span class="hljs-selector-class">.exe</span><br>â”‚   â””â”€â”€ ffprobe<span class="hljs-selector-class">.exe</span><br>â”œâ”€â”€ docs<br>â””â”€â”€ ...ï¼ˆå…¶ä»–æ–‡ä»¶å¤¹ï¼‰<br></code></pre></td></tr></table></figure></li></ol><h2 id="é…ç½®ç¯å¢ƒå˜é‡"><a href="#é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="é…ç½®ç¯å¢ƒå˜é‡"></a>é…ç½®ç¯å¢ƒå˜é‡</h2><p>ä¸ºäº†åœ¨å‘½ä»¤æç¤ºç¬¦ï¼ˆCMDï¼‰æˆ– PowerShell ä¸­éšæ—¶ä½¿ç”¨ FFmpeg å‘½ä»¤ï¼Œå»ºè®®å°† FFmpeg çš„ <code>bin</code> ç›®å½•æ·»åŠ åˆ°ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ä¸­ã€‚</p><ol><li><p><strong>æ‰“å¼€ç¯å¢ƒå˜é‡è®¾ç½®</strong>ï¼š</p><ul><li>å³é”®ç‚¹å‡»â€œæ­¤ç”µè„‘â€æˆ–â€œæˆ‘çš„ç”µè„‘â€ï¼Œé€‰æ‹©â€œå±æ€§â€ã€‚</li><li>ç‚¹å‡»å·¦ä¾§çš„â€œé«˜çº§ç³»ç»Ÿè®¾ç½®â€ã€‚</li><li>åœ¨â€œç³»ç»Ÿå±æ€§â€çª—å£ä¸­ï¼Œç‚¹å‡»â€œç¯å¢ƒå˜é‡â€æŒ‰é’®ã€‚</li></ul></li><li><p><strong>ç¼–è¾‘ PATH å˜é‡</strong>ï¼š</p><ul><li>åœ¨â€œç³»ç»Ÿå˜é‡â€åŒºåŸŸï¼Œæ‰¾åˆ°å¹¶é€‰ä¸­ <code>Path</code>ï¼Œç„¶åç‚¹å‡»â€œç¼–è¾‘â€ã€‚</li><li>ç‚¹å‡»â€œæ–°å»ºâ€ï¼Œç„¶åè¾“å…¥ FFmpeg çš„ <code>bin</code> ç›®å½•è·¯å¾„ï¼Œä¾‹å¦‚ <code>C:\ffmpeg\bin</code>ã€‚</li><li>ç¡®è®¤æ‰€æœ‰çª—å£ä»¥ä¿å­˜è®¾ç½®ã€‚</li></ul></li><li><p><strong>éªŒè¯å®‰è£…</strong>ï¼š</p><ul><li><p>æ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼ˆCMDï¼‰æˆ– PowerShellã€‚</p></li><li><p>è¾“å…¥ä»¥ä¸‹å‘½ä»¤å¹¶å›è½¦ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">ffmpeg -version<br></code></pre></td></tr></table></figure></li><li><p>å¦‚æœå®‰è£…æˆåŠŸï¼Œæ‚¨å°†çœ‹åˆ° FFmpeg çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚<img src="C:\Users\26578\AppData\Roaming\Typora\typora-user-images\image-20241027205527078.png" alt="image-20241027205527078"></p></li></ul></li></ol><h2 id="åŸºæœ¬ä½¿ç”¨æ–¹æ³•"><a href="#åŸºæœ¬ä½¿ç”¨æ–¹æ³•" class="headerlink" title="åŸºæœ¬ä½¿ç”¨æ–¹æ³•"></a>åŸºæœ¬ä½¿ç”¨æ–¹æ³•</h2><p>ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ FFmpeg å‘½ä»¤ç¤ºä¾‹ï¼Œå¸®åŠ©æ‚¨å¿«é€Ÿä¸Šæ‰‹.</p><h3 id="æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯"><a href="#æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯"></a>æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ffmpeg -version<br></code></pre></td></tr></table></figure><h3 id="è§†é¢‘æ ¼å¼è½¬æ¢"><a href="#è§†é¢‘æ ¼å¼è½¬æ¢" class="headerlink" title="è§†é¢‘æ ¼å¼è½¬æ¢"></a>è§†é¢‘æ ¼å¼è½¬æ¢</h3><p>å°†ä¸€ä¸ªè§†é¢‘æ–‡ä»¶ä»ä¸€ç§æ ¼å¼è½¬æ¢ä¸ºå¦ä¸€ç§æ ¼å¼ã€‚ä¾‹å¦‚ï¼Œå°† <code>input.mp4</code> è½¬æ¢ä¸º <code>output.avi</code>ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">ffmpeg -i input.mp4 output.avi<br></code></pre></td></tr></table></figure><h3 id="æå–éŸ³é¢‘"><a href="#æå–éŸ³é¢‘" class="headerlink" title="æå–éŸ³é¢‘"></a>æå–éŸ³é¢‘</h3><p>ä»è§†é¢‘æ–‡ä»¶ä¸­æå–éŸ³é¢‘ï¼Œä¿å­˜ä¸º MP3 æ ¼å¼ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">ffmpeg -<span class="hljs-selector-tag">i</span> <span class="hljs-selector-tag">input</span><span class="hljs-selector-class">.mp4</span> -<span class="hljs-selector-tag">q</span>:<span class="hljs-selector-tag">a</span> <span class="hljs-number">0</span> -map <span class="hljs-selector-tag">a</span> output.mp3<br></code></pre></td></tr></table></figure><h3 id="è§†é¢‘å‰ªè¾‘"><a href="#è§†é¢‘å‰ªè¾‘" class="headerlink" title="è§†é¢‘å‰ªè¾‘"></a>è§†é¢‘å‰ªè¾‘</h3><p>å‰ªåˆ‡è§†é¢‘çš„ä¸€éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œæˆªå– <code>input.mp4</code> ä»ç¬¬ 00:01:00 åˆ°ç¬¬ 00:02:00 çš„éƒ¨åˆ†ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ffmpeg</span> -ss <span class="hljs-number">00</span>:<span class="hljs-number">01</span>:<span class="hljs-number">00</span> -i input.mp4 -to <span class="hljs-number">00</span>:<span class="hljs-number">02</span>:<span class="hljs-number">00</span> -c copy output.mp4<br></code></pre></td></tr></table></figure><h3 id="åˆå¹¶è§†é¢‘æ–‡ä»¶"><a href="#åˆå¹¶è§†é¢‘æ–‡ä»¶" class="headerlink" title="åˆå¹¶è§†é¢‘æ–‡ä»¶"></a>åˆå¹¶è§†é¢‘æ–‡ä»¶</h3><p>å°†å¤šä¸ªè§†é¢‘æ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªã€‚é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ <code>filelist.txt</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs delphi"><span class="hljs-keyword">file</span> <span class="hljs-string">&#x27;video1.mp4&#x27;</span><br><span class="hljs-keyword">file</span> <span class="hljs-string">&#x27;video2.mp4&#x27;</span><br><span class="hljs-keyword">file</span> <span class="hljs-string">&#x27;video3.mp4&#x27;</span><br></code></pre></td></tr></table></figure><p>ç„¶åè¿è¡Œå‘½ä»¤ï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">ffmpeg -f <span class="hljs-built_in">concat</span> -safe <span class="hljs-number">0</span> -i filelist.txt -c copy <span class="hljs-built_in">output</span>.mp4<br></code></pre></td></tr></table></figure><h3 id="è½¬æ¢è§†é¢‘ç¼–ç "><a href="#è½¬æ¢è§†é¢‘ç¼–ç " class="headerlink" title="è½¬æ¢è§†é¢‘ç¼–ç "></a>è½¬æ¢è§†é¢‘ç¼–ç </h3><p>å°†è§†é¢‘ç¼–ç è½¬æ¢ä¸º H.264 ç¼–ç ï¼ŒéŸ³é¢‘ç¼–ç ä¸º AACï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">ffmpeg -<span class="hljs-selector-tag">i</span> <span class="hljs-selector-tag">input</span><span class="hljs-selector-class">.mkv</span> -c:v libx264 -c:<span class="hljs-selector-tag">a</span> aac output.mp4<br></code></pre></td></tr></table></figure><h3 id="è°ƒæ•´è§†é¢‘åˆ†è¾¨ç‡"><a href="#è°ƒæ•´è§†é¢‘åˆ†è¾¨ç‡" class="headerlink" title="è°ƒæ•´è§†é¢‘åˆ†è¾¨ç‡"></a>è°ƒæ•´è§†é¢‘åˆ†è¾¨ç‡</h3><p>å°†è§†é¢‘åˆ†è¾¨ç‡è°ƒæ•´ä¸º 1280x720ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ffmpeg</span> -i input.mp4 -vf scale=<span class="hljs-number">1280</span>:<span class="hljs-number">720</span> output.mp4<br></code></pre></td></tr></table></figure><h3 id="å‹ç¼©è§†é¢‘æ–‡ä»¶å¤§å°"><a href="#å‹ç¼©è§†é¢‘æ–‡ä»¶å¤§å°" class="headerlink" title="å‹ç¼©è§†é¢‘æ–‡ä»¶å¤§å°"></a>å‹ç¼©è§†é¢‘æ–‡ä»¶å¤§å°</h3><p>é€šè¿‡è°ƒæ•´æ¯”ç‰¹ç‡æ¥å‹ç¼©è§†é¢‘æ–‡ä»¶ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">ffmpeg -<span class="hljs-selector-tag">i</span> <span class="hljs-selector-tag">input</span><span class="hljs-selector-class">.mp4</span> -<span class="hljs-selector-tag">b</span>:v <span class="hljs-number">1000</span>k -<span class="hljs-selector-tag">b</span>:<span class="hljs-selector-tag">a</span> <span class="hljs-number">128</span>k output.mp4<br></code></pre></td></tr></table></figure><h3 id="æ·»åŠ å­—å¹•"><a href="#æ·»åŠ å­—å¹•" class="headerlink" title="æ·»åŠ å­—å¹•"></a>æ·»åŠ å­—å¹•</h3><p>å°†å¤–éƒ¨å­—å¹•æ–‡ä»¶ï¼ˆå¦‚ SRTï¼‰åµŒå…¥åˆ°è§†é¢‘ä¸­ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">ffmpeg -<span class="hljs-selector-tag">i</span> <span class="hljs-selector-tag">input</span><span class="hljs-selector-class">.mp4</span> -<span class="hljs-selector-tag">i</span> subtitles<span class="hljs-selector-class">.srt</span> -c copy -c:s mov_text output.mp4<br></code></pre></td></tr></table></figure><h3 id="å½•åˆ¶å±å¹•"><a href="#å½•åˆ¶å±å¹•" class="headerlink" title="å½•åˆ¶å±å¹•"></a>å½•åˆ¶å±å¹•</h3><p>å½•åˆ¶å…¨å±è§†é¢‘ï¼Œä¿å­˜ä¸º <code>output.mp4</code>ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ffmpeg</span> -f gdigrab -framerate <span class="hljs-number">30</span> -i desktop output.mp4<br></code></pre></td></tr></table></figure><h2 id="é«˜çº§ä½¿ç”¨"><a href="#é«˜çº§ä½¿ç”¨" class="headerlink" title="é«˜çº§ä½¿ç”¨"></a>é«˜çº§ä½¿ç”¨</h2><p>FFmpeg å…·æœ‰æå…¶ä¸°å¯Œçš„åŠŸèƒ½ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›é«˜çº§åº”ç”¨åœºæ™¯ï¼š</p><h3 id="æµåª’ä½“æ¨æµ"><a href="#æµåª’ä½“æ¨æµ" class="headerlink" title="æµåª’ä½“æ¨æµ"></a>æµåª’ä½“æ¨æµ</h3><p>å°†è§†é¢‘æµæ¨é€åˆ° RTMP æœåŠ¡å™¨ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus">bash<br><br><br>å¤åˆ¶ä»£ç <br>ffmpeg -re -<span class="hljs-selector-tag">i</span> <span class="hljs-selector-tag">input</span><span class="hljs-selector-class">.mp4</span> -c:v libx264 -preset veryfast -maxrate <span class="hljs-number">3000</span>k -bufsize <span class="hljs-number">6000</span>k -c:<span class="hljs-selector-tag">a</span> aac -<span class="hljs-selector-tag">b</span>:<span class="hljs-selector-tag">a</span> <span class="hljs-number">160</span>k -f flv rtmp:<span class="hljs-comment">//yourserver/live/stream</span><br></code></pre></td></tr></table></figure><h3 id="è§†é¢‘æ°´å°"><a href="#è§†é¢‘æ°´å°" class="headerlink" title="è§†é¢‘æ°´å°"></a>è§†é¢‘æ°´å°</h3><p>åœ¨è§†é¢‘ä¸Šæ·»åŠ å›¾ç‰‡æ°´å°ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus">bash<br><br><br>å¤åˆ¶ä»£ç <br>ffmpeg -<span class="hljs-selector-tag">i</span> <span class="hljs-selector-tag">input</span><span class="hljs-selector-class">.mp4</span> -<span class="hljs-selector-tag">i</span> watermark<span class="hljs-selector-class">.png</span> -filter_complex <span class="hljs-string">&quot;overlay=10:10&quot;</span> output.mp4<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://ffmpeg.org/documentation.html">FFmpeg å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://ffmpeg.org.cn/">FFmpeg ä¸­æ–‡ç½‘</a></li><li><a href="https://www.ffmpeg.org/ffmpeg.html">FFmpeg å‘½ä»¤å¤§å…¨</a></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>ffmpeg</tag>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WSL2å®‰è£…dockerå’Œé…ç½®docker composeå¹¶ç¼–æ’æœåŠ¡</title>
    <link href="/2024/10/27/WSL2%E5%AE%89%E8%A3%85docker%E5%92%8C%E9%85%8D%E7%BD%AEdocker-compose%E5%B9%B6%E7%BC%96%E6%8E%92%E6%9C%8D%E5%8A%A1/"/>
    <url>/2024/10/27/WSL2%E5%AE%89%E8%A3%85docker%E5%92%8C%E9%85%8D%E7%BD%AEdocker-compose%E5%B9%B6%E7%BC%96%E6%8E%92%E6%9C%8D%E5%8A%A1/</url>
    
    <content type="html"><![CDATA[<p>åœ¨WSL2ä¸‹å®‰è£…Dockerå’ŒDocker Composeå¹¶åˆ›å»ºä¸€ä¸ª docker-compose.yml æ–‡ä»¶æ¥ç¼–æ’ MySQLã€Redis å’Œ MongoDB æœåŠ¡çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>å®‰è£…Docker<br>é¦–å…ˆåœ¨WSL2é•œåƒä¸Šå®‰è£…Dockerï¼š</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt update<br><span class="hljs-built_in">sudo</span> apt install docker-ce docker-ce-cli containerd.io -y<br></code></pre></td></tr></table></figure><ol start="2"><li>å®‰è£…Docker Compose<br>Docker Compose æ˜¯ä¸€ä¸ªå¸®åŠ©ä½ å®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨Dockeråº”ç”¨çš„å·¥å…·ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å®‰è£…ï¼š</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> curl -L <span class="hljs-string">&quot;https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-<span class="hljs-subst">$(uname -s)</span>-<span class="hljs-subst">$(uname -m)</span>&quot;</span> -o /usr/local/bin/docker-compose<br></code></pre></td></tr></table></figure><p>ç„¶åï¼Œç»™äºˆå®ƒæ‰§è¡Œæƒé™ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">chmod</span> +x /usr/local/bin/docker-compose<br></code></pre></td></tr></table></figure><p>éªŒè¯å®‰è£…æˆåŠŸï¼š</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">docker-compose <span class="hljs-comment">--version</span><br></code></pre></td></tr></table></figure><ol start="3"><li>åˆ›å»ºdocker-compose.ymlæ–‡ä»¶<br>ç°åœ¨åˆ›å»ºä¸€ä¸ªdocker-compose.ymlæ–‡ä»¶ï¼Œå°† MySQLã€Redis å’Œ MongoDB å®šä¹‰ä¸ºæœåŠ¡ï¼Œå¹¶å°†å®ƒä»¬çš„æ•°æ®ç›®å½•æ˜ å°„åˆ°å®¿ä¸»æœºä¸Šã€‚</li></ol><p>åœ¨ä½ å–œæ¬¢çš„ç›®å½•ä¸­åˆ›å»º docker-compose.yml æ–‡ä»¶ç„¶åç¼–è¾‘æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nano docker-compose.yml<br></code></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&#x27;3.8&#x27;</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">mysql:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">mysql:8.0</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">mysql-container</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-string">rootpassword</span><br>      <span class="hljs-attr">MYSQL_DATABASE:</span> <span class="hljs-string">mydb</span><br>      <span class="hljs-attr">MYSQL_USER:</span> <span class="hljs-string">user</span><br>      <span class="hljs-attr">MYSQL_PASSWORD:</span> <span class="hljs-string">password</span><br>    <span class="hljs-attr">ports:</span><br><br>   <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;3306:3306&quot;</span><br>     <span class="hljs-attr">lumes:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-string">./mysql_data:/var/lib/mysql</span><br>          <span class="hljs-attr">tworks:</span><br>             <span class="hljs-bullet">-</span> <span class="hljs-string">backend</span><br><br>  <span class="hljs-attr">redis:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">redis:latest</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">redis-container</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;6379:6379&quot;</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./redis_data:/data</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">backend</span><br><br>  <span class="hljs-attr">mongo:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">mongo:latest</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">mongo-container</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;27017:27017&quot;</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./mongo_data:/data/db</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">backend</span><br><br><span class="hljs-attr">networks:</span><br>  <span class="hljs-attr">backend:</span><br>    <span class="hljs-attr">driver:</span> <span class="hljs-string">bridge</span><br><br></code></pre></td></tr></table></figure><p>4.å¯åŠ¨æœåŠ¡<br>ä¿å­˜å¹¶é€€å‡ºç¼–è¾‘å™¨ï¼Œç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨æœåŠ¡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker-compose up -d<br></code></pre></td></tr></table></figure><p>è¿™å°†å¯åŠ¨ MySQLã€Redis å’Œ MongoDB ä¸‰ä¸ªå®¹å™¨ï¼Œå¹¶ä½¿å®ƒä»¬åœ¨åå°è¿è¡Œã€‚</p><ol start="5"><li>ç™»å½•åˆ° MySQLã€Redis å’Œ MongoDB<br>ç°åœ¨ï¼Œåˆ†åˆ«ç™»å½•åˆ°è¿™äº›æœåŠ¡ä¸­ã€‚</li></ol><p>ç™»å½•åˆ°MySQLï¼š<br>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿æ¥åˆ° MySQL å®¹å™¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker <span class="hljs-built_in">exec</span> -it mysql-container mysql -u root -p<br></code></pre></td></tr></table></figure><p>ä½ å°†ä¼šæç¤ºè¾“å…¥å¯†ç ï¼Œè¾“å…¥ä½ åœ¨ docker-compose.yml æ–‡ä»¶ä¸­è®¾ç½®çš„ MYSQL_ROOT_PASSWORD (rootpassword)ã€‚</p><p>ç™»å½•åˆ°Redisï¼š<br>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿æ¥åˆ° Redis å®¹å™¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker <span class="hljs-built_in">exec</span> -it redis-container redis-cli<br></code></pre></td></tr></table></figure><p>ç™»å½•åˆ°MongoDBï¼š<br>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿æ¥åˆ° Mongo å®¹å™¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker <span class="hljs-built_in">exec</span> -it mongo-container mongo<br></code></pre></td></tr></table></figure><ol start="6"><li>æ£€æŸ¥æ•°æ®æŒä¹…åŒ–<br>æœåŠ¡çš„æ•°æ®å°†æ˜ å°„åˆ°å®¿ä¸»æœºçš„ç›®å½•ä¸­ï¼ˆ.&#x2F;mysql_dataã€.&#x2F;redis_data å’Œ .&#x2F;mongo_dataï¼‰ï¼Œå¯ä»¥é€šè¿‡è¿™äº›æ–‡ä»¶å¤¹æŸ¥çœ‹æœåŠ¡çš„æŒä¹…åŒ–æ•°æ®ã€‚</li></ol><p>æ€»ç»“<br>ä½ ç°åœ¨å·²ç»åœ¨WSL2ç³»ç»Ÿä¸­å®‰è£…äº†Dockerå’ŒDocker Composeï¼Œå¹¶ä½¿ç”¨ docker-compose.yml æ–‡ä»¶ç¼–æ’ MySQLã€Redis å’Œ MongoDB æœåŠ¡ã€‚æœåŠ¡å¯åŠ¨åï¼Œå¯ä»¥é€šè¿‡ docker exec å‘½ä»¤ç™»å½•åˆ°æ¯ä¸ªæœåŠ¡ä¸­ï¼Œæ•°æ®ä¹Ÿè¢«æ˜ å°„åˆ°å®¿ä¸»æœºçš„ç›®å½•ï¼Œç¡®ä¿æ•°æ®æŒä¹…åŒ–ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>wsl windos docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JJWT 0.12.6æ›´æ–°å­¦ä¹ </title>
    <link href="/2024/10/24/JJWT%200.12.6%E6%9B%B4%E6%96%B0%E5%AD%A6%E4%B9%A0/"/>
    <url>/2024/10/24/JJWT%200.12.6%E6%9B%B4%E6%96%B0%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å­¦ä¹ JWTæ—¶é‡åˆ°è®¸å¤šæ–¹æ³•æ˜¾ç¤ºå·²å¼ƒç”¨,JWTæ›´æ–°é€Ÿåº¦éå¸¸å¿«,ç½‘ä¸Šçš„æ•™ç¨‹å’ŒAIå›å¤å¤§å¤šç¼ºä¹æ—¶æ•ˆæ€§,å› æ­¤æˆ‘è®°å½•ä¸‹æ›´æ–°å­¦ä¹ çš„è¿‡ç¨‹;æœ¬æ–‡å‚è€ƒJWT GitHubé¦–é¡µ:</p><p><a href="https://github.com/jwtk/jjwt?tab=readme-ov-file">https://github.com/jwtk/jjwt?tab=readme-ov-file</a></p><p>;å¹¶æ„Ÿè°¢ChatGPTæä¾›äº†è¯¦å°½çš„è§£é‡Š.</p><p>JWTåŸºç¡€çŸ¥è¯†:</p><p><strong>JWT (JSON Web Token)</strong>:** æ˜¯ä¸€ç§åŸºäºJSONçš„ä»¤ç‰Œï¼Œç”¨äºåœ¨ç½‘ç»œåº”ç”¨ä¸­å®‰å…¨åœ°ä¼ è¾“ä¿¡æ¯ã€‚å®ƒé€šå¸¸ç”¨äºèº«ä»½éªŒè¯å’Œæˆæƒã€‚JWTç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š<code>Header</code>ã€<code>Payload</code> å’Œ <code>Signature</code>ï¼Œé€šè¿‡ç‚¹å·ï¼ˆ<code>.</code>ï¼‰åˆ†éš”ã€‚JWTå¯ä»¥ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§ï¼ˆä¸å¯ç¯¡æ”¹ï¼‰å¹¶é€šè¿‡åŠ å¯†ä¿è¯æ•æ„Ÿä¿¡æ¯çš„å®‰å…¨ã€‚</p><table><thead><tr><th align="left"><strong>éƒ¨åˆ†</strong></th><th><strong>æè¿°</strong></th><th><strong>ç¤ºä¾‹</strong></th></tr></thead><tbody><tr><td align="left"><strong>Header</strong></td><td>å®šä¹‰äº†JWTçš„å…ƒæ•°æ®ï¼Œä¸»è¦åŒ…æ‹¬ç­¾åç®—æ³•å’Œä»¤ç‰Œç±»å‹ã€‚</td><td><code>json&lt;br&gt;&#123; &quot;alg&quot;: &quot;HS256&quot;,&lt;br&gt; &quot;typ&quot;: &quot;JWT&quot;&#125;</code></td></tr><tr><td align="left"><strong>Payload</strong></td><td>åŒ…å«å®é™…ä¼ é€’çš„æ•°æ®ï¼ˆå£°æ˜ï¼‰ï¼Œå¯ä»¥åŒ…æ‹¬æ³¨å†Œå£°æ˜ã€å…¬å…±å£°æ˜å’Œç§æœ‰å£°æ˜ã€‚</td><td><code>json&#123; &quot;sub&quot;: &quot;1234567890&quot;, &quot;name&quot;: &quot;John Doe&quot;,&quot;admin&quot;: true, &quot;exp&quot;: 1516239022&lt;br&gt;&#125;</code></td></tr><tr><td align="left"><strong>Signature</strong></td><td>ç”¨äºéªŒè¯JWTçš„å®Œæ•´æ€§å’ŒçœŸå®æ€§ï¼Œé€šè¿‡å¯¹Headerå’ŒPayloadè¿›è¡Œç­¾åç”Ÿæˆã€‚</td><td><code>HMACSHA256(base64UrlEncode(Header) + &quot;.&quot; + base64UrlEncode(Payload), secret)</code></td></tr></tbody></table><p><strong>JJWT(Java JWT)</strong>:** æ˜¯ä¸€ä¸ªJavaåº“ï¼Œç”¨äºåˆ›å»ºå’ŒéªŒè¯JWTï¼ˆJSON Web Tokenï¼‰ã€‚å®ƒç®€åŒ–äº†åœ¨Javaåº”ç”¨ä¸­ä½¿ç”¨JWTçš„è¿‡ç¨‹ã€‚JJWTç”±ä¸€ä¸ªå¼€æºç¤¾åŒºå¼€å‘ï¼Œæ”¯æŒç”Ÿæˆã€è§£æå’ŒéªŒè¯JWTçš„åŠŸèƒ½ã€‚æœ¬æ–‡å­¦ä¹ çš„æ˜¯æœ€æ–°çš„JJWTã€‚</p><p><strong>JWS(JSON Web Signature):</strong> æ˜¯ä¸€ç§ç”¨æ¥ç”Ÿæˆå’ŒéªŒè¯æ•°å­—ç­¾åçš„æ ‡å‡†ï¼ŒåŸºäºJSONæ ¼å¼ã€‚JWSç¡®ä¿äº†æ•°æ®çš„å®Œæ•´æ€§å’ŒçœŸå®æ€§ã€‚JWTçš„ç­¾åéƒ¨åˆ†å®é™…ä¸Šå°±æ˜¯ä½¿ç”¨äº†JWSã€‚</p><p><strong>JWE(JSON Web Encryption)</strong>: æ˜¯ä¸€ç§ç”¨æ¥åŠ å¯†æ•°æ®çš„æ ‡å‡†ï¼Œä¹ŸåŸºäºJSONæ ¼å¼ã€‚JWEä¸JWSä¸åŒä¹‹å¤„åœ¨äºï¼ŒJWSä¿è¯æ•°æ®çš„å®Œæ•´æ€§ï¼ˆæ•°æ®ä¸å¯ç¯¡æ”¹ï¼‰ï¼Œè€ŒJWEç¡®ä¿æ•°æ®çš„æœºå¯†æ€§ï¼ˆæ•°æ®åŠ å¯†åä¸å¯è¢«è¯»å–ï¼‰ã€‚</p><p>1.å¼•å…¥ä¾èµ–</p><p>å¼•å…¥JWTæœ€æ–°çš„mavenä¾èµ–:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dependency&gt;<br>  &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;<br>  &lt;artifactId&gt;jjwt-api&lt;/artifactId&gt;<br>  &lt;version&gt;<span class="hljs-number">0.12</span><span class="hljs-number">.6</span>&lt;/version&gt;<br>&lt;/dependency&gt;<br>&lt;dependency&gt;<br>  &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;<br>  &lt;artifactId&gt;jjwt-impl&lt;/artifactId&gt;<br>  &lt;version&gt;<span class="hljs-number">0.12</span><span class="hljs-number">.6</span>&lt;/version&gt;<br>  &lt;scope&gt;runtime&lt;/scope&gt;<br>&lt;/dependency&gt;<br>&lt;dependency&gt;<br>  &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;<br>  &lt;artifactId&gt;jjwt-jackson&lt;/artifactId&gt; &lt;!-- or jjwt-gson <span class="hljs-keyword">if</span> Gson is preferred --&gt;<br>  &lt;version&gt;<span class="hljs-number">0.12</span><span class="hljs-number">.6</span>&lt;/version&gt;<br>  &lt;scope&gt;runtime&lt;/scope&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure><p>2.ç”ŸæˆJWS</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç”Ÿæˆä¸€ä¸ªHS256ç®—æ³•çš„å¯†é’¥</span><br><span class="hljs-type">SecretKey</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> Jwts.SIG.HS256.key().build();<br><br><span class="hljs-type">String</span> <span class="hljs-variable">jws</span> <span class="hljs-operator">=</span> Jwts.builder()<br>           <span class="hljs-comment">// è®¾ç½®JWTçš„ä¸»ä½“éƒ¨åˆ†ï¼Œé€šå¸¸åŒ…å«ç”¨æˆ·æ ‡è¯†</span><br>           .subject(<span class="hljs-string">&quot;sub&quot;</span>) <br>           <br>           <span class="hljs-comment">// æ·»åŠ è‡ªå®šä¹‰å£°æ˜</span><br>           .claim(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;message&quot;</span>)<br>           <br>           <span class="hljs-comment">// ç”Ÿæˆçš„å¯†é’¥å¯¹JWTè¿›è¡Œç­¾å</span><br>           .signWith(key)<br>           <br>           <span class="hljs-comment">// è®¾ç½®JWTçš„å‘è¡Œè€…ä¿¡æ¯</span><br>           .issuer(<span class="hljs-string">&quot;example.com&quot;</span>)<br>           <br>           <span class="hljs-comment">// è®¾ç½®JWTçš„å‘è¡Œæ—¶é—´</span><br>           .issuedAt(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(System.currentTimeMillis()))<br>           <br>           <span class="hljs-comment">// è®¾ç½®JWTçš„è¿‡æœŸæ—¶é—´ï¼Œè¿™é‡Œè®¾ç½®ä¸ºå½“å‰æ—¶é—´åŠ 1å°æ—¶</span><br>           .expiration(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(System.currentTimeMillis() + <span class="hljs-number">3600000</span>))<br>           <br>           <span class="hljs-comment">//ç”Ÿæˆæœ€ç»ˆçš„JWTå­—ç¬¦ä¸²</span><br>           .compact();<br>&#125;<br></code></pre></td></tr></table></figure><p>3.è§£æJWS</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">Jws&lt;Claims&gt; claimsJws = Jwts.parser()<br>        <span class="hljs-comment">// ä½¿ç”¨æŒ‡å®šçš„å¯†é’¥éªŒè¯JWTçš„ç­¾å</span><br>        .verifyWith(key)<br>        .build()<br>        <span class="hljs-comment">// è§£æJWTå¹¶éªŒè¯å…¶ç­¾åï¼Œè¿”å›åŒ…å«claimsçš„Jwså¯¹è±¡</span><br>        .parseSignedClaims(jws);<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>-java -Spring -JWT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Spring  Vue3å®ç°ToDoListå¾…åŠäº‹é¡¹åˆ—è¡¨</title>
    <link href="/2024/10/24/Spring-Vue3%E5%AE%9E%E7%8E%B0ToDoList%E5%BE%85%E5%8A%9E%E4%BA%8B%E9%A1%B9%E5%88%97%E8%A1%A8/"/>
    <url>/2024/10/24/Spring-Vue3%E5%AE%9E%E7%8E%B0ToDoList%E5%BE%85%E5%8A%9E%E4%BA%8B%E9%A1%B9%E5%88%97%E8%A1%A8/</url>
    
    <content type="html"><![CDATA[<p>ä¸ºäº†ç†Ÿæ‚‰spring,ç»ƒä¹ TodoListçš„å®ä¾‹,ä»¥æœ¬æ–‡è®°å½•å­¦ä¹ è¿‡ç¨‹:</p><p>1.æ·»åŠ ç›¸å…³ä¾èµ–:æœ¬é¡¹ç›®ä½¿ç”¨çš„æ˜¯spring boot+vue3 æ•°æ®åº“ä½¿ç”¨MySQL,æŒä¹…å±‚ä½¿ç”¨JPA</p><p>åç«¯Api</p><p>2.å»ºè¡¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mysql">create table todo(id int auto_increment primary key ,<br>                title varchar(50) ,<br>                description varchar(100),<br>                completed boolean default false,<br>                created_at TIMESTAMP default CURRENT_TIMESTAMP);<br></code></pre></td></tr></table></figure><p>3.application.propertiesé…ç½®æ•°æ®åº“è¿æ¥</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">spring.datasource.username</span>=<span class="hljs-string">xxx</span><br><span class="hljs-attr">spring.datasource.password</span>=<span class="hljs-string">xxx</span><br><span class="hljs-attr">spring.datasource.driver-class-name</span>=<span class="hljs-string">com.mysql.cj.jdbc.Driver</span><br><span class="hljs-attr">spring.datasource.url</span>=<span class="hljs-string">jdbc:mysql://localhost:3306/todolist</span><br></code></pre></td></tr></table></figure><p>4.åˆ›å»ºå®ä½“ç±»Todoå¹¶ä½¿ç”¨JPAæ³¨è§£æ˜ å°„æ•°æ®åº“è¡¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@Entity</span><br><span class="hljs-meta">@Table(name = &quot;todo&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Todo</span> &#123;<br>    <span class="hljs-meta">@Id</span><br>    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> id;<br><br>    <span class="hljs-keyword">private</span> String title;<br>    <span class="hljs-keyword">private</span> String description;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> completed;<br><br>    <span class="hljs-meta">@Temporal(TemporalType.TIMESTAMP)</span> <span class="hljs-comment">//æŒ‡å®šcreate_atå­—æ®µä¸ºæ—¶é—´æˆ³ç±»å‹</span><br>    <span class="hljs-keyword">private</span> Date create_at;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">@Repository<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-symbol">TodoRepository</span> <span class="hljs-symbol">extends</span> <span class="hljs-symbol">JpaRepository</span>&lt;<span class="hljs-symbol">Todo</span>,<span class="hljs-symbol">Integer</span>&gt; &#123;<br>&#125;<br></code></pre></td></tr></table></figure><p>4.å®ŒæˆTodoService,å®ç°å¯¹Todoçš„æ“ä½œ</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TodoService</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-title class_">TodoRepository</span> todoRepository;<br>    <span class="hljs-title class_">Todo</span> todo;<br><br>    <span class="hljs-comment">//åˆ—å‡ºæ‰€æœ‰Todo</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">Todo</span>&gt; <span class="hljs-title function_">findAllTodo</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> todoRepository.<span class="hljs-title function_">findAll</span>();<br>    &#125;<br><br>    <span class="hljs-comment">//æ ¹æ®idæŸ¥æ‰¾todo</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Optional</span>&lt;<span class="hljs-title class_">Todo</span>&gt; <span class="hljs-title function_">finTodoById</span>(<span class="hljs-params">int id</span>)&#123; <span class="hljs-comment">//ä½¿ç”¨OptionalåŒ…è£…,é¿å…è¿”å›null</span><br>        <span class="hljs-keyword">return</span> todoRepository.<span class="hljs-title function_">findById</span>(id);<br>    &#125;<br><br>    <span class="hljs-comment">//æ·»åŠ todo</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Todo</span> <span class="hljs-title function_">addTodo</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title class_">Todo</span> newTodo = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Todo</span>();<br>        <span class="hljs-keyword">return</span> newTodo;<br>    &#125;<br><br>    <span class="hljs-comment">//ä¿®æ”¹todo</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">updateTodo</span>(<span class="hljs-params"><span class="hljs-title class_">Todo</span> todo, <span class="hljs-title class_">String</span> title, <span class="hljs-title class_">String</span> description, <span class="hljs-built_in">boolean</span> completed</span>) &#123;<br>        todo.<span class="hljs-title function_">setTitle</span>(title);<br>        todo.<span class="hljs-title function_">setDescription</span>(description);<br>        todo.<span class="hljs-title function_">setCompleted</span>(completed);<br>    &#125;<br><br>    <span class="hljs-comment">//åˆ é™¤todo</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">deleteTodo</span>(<span class="hljs-params">int id</span>)&#123;<br>        <span class="hljs-keyword">if</span> (todoRepository.<span class="hljs-title function_">findById</span>(id).<span class="hljs-title function_">isPresent</span>())&#123;<br>            todoRepository.<span class="hljs-title function_">deleteById</span>(id);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>5.å®ŒæˆTodoController,è°ƒç”¨æœåŠ¡å±‚æ–¹æ³•,å®ç°åç«¯æ¥å£</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">&quot;/api/todo&quot;</span>)<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TodoController</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-title class_">TodoService</span> todoService;<br>    <span class="hljs-title class_">Todo</span> todo;<br><br>    <span class="hljs-comment">//åˆ—å‡ºæ‰€æœ‰Todo</span><br>    <span class="hljs-meta">@GetMapping</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">Todo</span>&gt; <span class="hljs-title function_">findAllTodo</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> todoService.<span class="hljs-title function_">findAllTodo</span>();<br>    &#125;<br><br>    <span class="hljs-comment">//æ ¹æ®idæŸ¥æ‰¾Todo</span><br>    <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">&quot;/&#123;id&#125;&quot;</span>)<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Optional</span>&lt;<span class="hljs-title class_">Todo</span>&gt; <span class="hljs-title function_">findTodoById</span>(<span class="hljs-params"><span class="hljs-meta">@PathVariable</span> int id</span>)&#123;<br>        <span class="hljs-keyword">return</span> todoService.<span class="hljs-title function_">finTodoById</span>(id);<br>    &#125;<br><br>    <span class="hljs-comment">//æ·»åŠ Todo</span><br>    <span class="hljs-meta">@PostMapping</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Todo</span> <span class="hljs-title function_">addTodo</span>(<span class="hljs-params"><span class="hljs-meta">@RequestBody</span> <span class="hljs-title class_">Todo</span> newTodo</span>)&#123;<br>        <span class="hljs-keyword">return</span> todoService.<span class="hljs-title function_">addTodo</span>(newTodo);<br>    &#125;<br><br>    <span class="hljs-comment">//åˆ é™¤Todo</span><br>    <span class="hljs-meta">@DeleteMapping</span>(<span class="hljs-string">&quot;/&#123;id&#125;&quot;</span>)<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">deleteTodo</span>(<span class="hljs-params"><span class="hljs-meta">@PathVariable</span> int id</span>)&#123;<br>       todoService.<span class="hljs-title function_">deleteTodo</span>(id);<br>    &#125;<br><br>    <span class="hljs-comment">//ä¿®æ”¹Todo</span><br>    <span class="hljs-meta">@PutMapping</span>(<span class="hljs-string">&quot;/&#123;id&#125;&quot;</span>)<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Todo</span> <span class="hljs-title function_">updateTodo</span>(<span class="hljs-params"><span class="hljs-meta">@PathVariable</span> int id,<span class="hljs-meta">@RequestBody</span> <span class="hljs-title class_">Todo</span> updatetodo</span>) &#123;<br>        todoService.<span class="hljs-title function_">updateTodo</span>(todo,updatetodo.<span class="hljs-title function_">getTitle</span>(), updatetodo.<span class="hljs-title function_">getDescription</span>(), updatetodo.<span class="hljs-title function_">isCompleted</span>());<br>        <span class="hljs-keyword">return</span> todo;<br>    &#125;&#125;<br></code></pre></td></tr></table></figure><p>å‰ç«¯é¡µé¢</p><template>   <div class="todo-list">     <h1>å¾…åŠäº‹é¡¹</h1>     <form @submit.prevent="addTodo">       <input v-model="newTodo.title" placeholder="æ ‡é¢˜" required />       <input v-model="newTodo.description" placeholder="æè¿°" />       <button type="submit">æ·»åŠ </button>     </form>     <ul>       <li v-for="todo in todos" :key="todo.id">         <span :class="{ completed: todo.completed }">            -          </span>         <button @click="toggleComplete(todo)">å®Œæˆ</button>         <button @click="deleteTodo(todo.id)">åˆ é™¤</button>       </li>     </ul>   </div></template><script> import axios from 'axios';<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs javascript"> <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>   <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>     <span class="hljs-keyword">return</span> &#123;<br>       <span class="hljs-attr">todos</span>: [],<br>       <span class="hljs-attr">newTodo</span>: &#123;<br>         <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>         <span class="hljs-attr">description</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>         <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span><br>       &#125;<br>     &#125;;<br>   &#125;,<br>   <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123; <span class="hljs-comment">// ç§»åˆ°æ ¹å¯¹è±¡</span><br>     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fetchTodos</span>();<br>   &#125;,<br>   <span class="hljs-attr">methods</span>: &#123;<br>     <span class="hljs-keyword">async</span> <span class="hljs-title function_">fetchTodos</span>(<span class="hljs-params"></span>) &#123;<br>       <span class="hljs-keyword">try</span> &#123;<br>         <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;http://localhost:8080/api/todo/all&#x27;</span>);<br>         <span class="hljs-variable language_">this</span>.<span class="hljs-property">todos</span> = response.<span class="hljs-property">data</span>;<br>       &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>         <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error);<br>       &#125;<br>     &#125;,<br>     <span class="hljs-keyword">async</span> <span class="hljs-title function_">addTodo</span>(<span class="hljs-params"></span>) &#123;<br>       <span class="hljs-keyword">try</span> &#123;<br>         <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;http://localhost:8080/api/todo&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">newTodo</span>);<br>         <span class="hljs-variable language_">this</span>.<span class="hljs-property">todos</span>.<span class="hljs-title function_">push</span>(response.<span class="hljs-property">data</span>);<br>         <span class="hljs-variable language_">this</span>.<span class="hljs-property">newTodo</span> = &#123;<br>           <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>           <span class="hljs-attr">description</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>           <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span><br>         &#125;;<br>       &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>         <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error);<br>       &#125;<br>     &#125;,<br>     <span class="hljs-keyword">async</span> <span class="hljs-title function_">toggleComplete</span>(<span class="hljs-params">todo</span>) &#123;<br>       <span class="hljs-keyword">try</span> &#123;<br>         <span class="hljs-keyword">const</span> updatedTodo = &#123; ...todo, <span class="hljs-attr">completed</span>: !todo.<span class="hljs-property">completed</span> &#125;;<br>         <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">put</span>(<span class="hljs-string">`http://localhost:8080/api/todo/<span class="hljs-subst">$&#123;todo.id&#125;</span>`</span>, updatedTodo);<br>         <span class="hljs-keyword">const</span> insex = <span class="hljs-variable language_">this</span>.<span class="hljs-property">todos</span>.<span class="hljs-title function_">indexOf</span>(todo);<br>         <span class="hljs-variable language_">this</span>.<span class="hljs-property">todos</span>.<span class="hljs-title function_">splice</span>(insex, <span class="hljs-number">1</span>, updatedTodo); <span class="hljs-comment">// ä½¿ç”¨æ­£ç¡®çš„å˜é‡å</span><br>       &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>         <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error);<br>       &#125;<br>     &#125;,<br>     <span class="hljs-keyword">async</span> <span class="hljs-title function_">deleteTodo</span>(<span class="hljs-params">id</span>) &#123;<br>       <span class="hljs-keyword">try</span> &#123;<br>         <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">delete</span>(<span class="hljs-string">`http://localhost:8080/api/todo/<span class="hljs-subst">$&#123;id&#125;</span>`</span>);<br>         <span class="hljs-variable language_">this</span>.<span class="hljs-property">todos</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">todos</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> todo.<span class="hljs-property">id</span> !== id);<br>       &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>         <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error);<br>       &#125;<br>     &#125;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure></script><style scoped>#app { height: 90vh; display: flex; align-items: center; justify-content: center;}</style>]]></content>
    
    
    
    <tags>
      
      <tag>java, spring, vue3</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>test</title>
    <link href="/2024/10/23/test/"/>
    <url>/2024/10/23/test/</url>
    
    <content type="html"><![CDATA[<p>å®£å·è°¢æœ“æ¥¼é¥¯åˆ«æ ¡ä¹¦å”äº‘</p><p>æç™½</p><p>å¼ƒæˆ‘å»è€…ï¼Œæ˜¨æ—¥ä¹‹æ—¥ä¸å¯ç•™;ä¹±æˆ‘å¿ƒè€…ï¼Œä»Šæ—¥ä¹‹æ—¥å¤šçƒ¦å¿§ã€‚</p><p>é•¿é£ä¸‡é‡Œé€ç§‹é›ï¼Œå¯¹æ­¤å¯ä»¥é…£é«˜æ¥¼ã€‚</p><p>è“¬è±æ–‡ç« å»ºå®‰éª¨ï¼Œä¸­é—´å°è°¢åˆæ¸…å‘ã€‚</p><p>ä¿±æ€€é€¸å…´å£®æ€é£ï¼Œæ¬²ä¸Šé’å¤©è§ˆæ˜æœˆã€‚</p><p>æŠ½åˆ€æ–­æ°´æ°´æ›´æµï¼Œä¸¾æ¯æ¶ˆæ„æ„æ›´æ„ã€‚</p><p>äººç”Ÿåœ¨ä¸–ä¸ç§°æ„ï¼Œæ˜æœæ•£å‘å¼„æ‰èˆŸã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2024/10/21/hello-world/"/>
    <url>/2024/10/21/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
